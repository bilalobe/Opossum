<!DOCTYPE html>
<html class="writer-html5" lang="en"> <head><meta charset="utf-8"/><meta content="IE=edge" http-equiv="X-UA-Compatible"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="bebo" name="author"/><link href="../../img/favicon.ico" rel="shortcut icon"/><title>Capability Matrix - Opossum Search Documentation</title><link href="../../css/theme.css" rel="stylesheet"/><link href="../../css/theme_extra.css" rel="stylesheet"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/><script>
        // Current page data
        var mkdocs_page_name = "Capability Matrix";
        var mkdocs_page_input_path = "model-integration\\capability-matrix.md";
        var mkdocs_page_url = null;
      </script><!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]--><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script><script>hljs.highlightAll();</script></head> <body class="wy-body-for-nav" role="document"> <div class="wy-grid-for-nav"> <nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift"> <div class="wy-side-scroll"> <div class="wy-side-nav-search"> <a class="icon icon-home" href="../.."> Opossum Search Documentation </a><div role="search"> <form action="../../search.html" class="wy-form" id="rtd-search-form" method="get"> <input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/> </form> </div> </div> <div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation"> <ul> <li class="toctree-l1"><a class="reference internal" href="../..">Home</a> </li> </ul> <p class="caption"><span class="caption-text">Technical &amp; Development</span></p> <ul> <li class="toctree-l1"><a class="reference internal">Architecture</a> <ul> <li class="toctree-l2"><a class="reference internal" href="../../technical/system-architecture-overview/">System Architecture Overview</a> </li> </ul> </li> <li class="toctree-l1"><a class="reference internal">Core Components</a> <ul> <li class="toctree-l2"><a class="reference internal" href="../../technical/redis-caching-architecture/">Redis Caching Architecture</a> </li> <li class="toctree-l2"><a class="reference internal" href="../../technical/hybrid-model-selection/">Hybrid Model Selection</a> </li> <li class="toctree-l2"><a class="reference internal" href="../../technical/image-processing-pipeline/">Image Processing Pipeline</a> </li> <li class="toctree-l2"><a class="reference internal" href="../../technical/graphql-api/">GraphQL API</a> </li> <li class="toctree-l2"><a class="reference internal" href="../../technical/opentelemetry-integration/">OpenTelemetry Integration</a> </li> <li class="toctree-l2"><a class="reference internal" href="../../technical/svg-markup/">SVG Markup</a> </li> <li class="toctree-l2"><a class="reference internal" href="../../technical/devops-guide/">DevOps Guide</a> </li> </ul> </li> <li class="toctree-l1"><a class="reference internal">Development Workflow</a> <ul> <li class="toctree-l2"><a class="reference internal" href="../../technical/getting-started/">Getting Started</a> </li> </ul> </li> <li class="toctree-l1"><a class="reference internal">Operations</a> <ul> <li class="toctree-l2"><a class="reference internal" href="../../technical/security-model/">Security Model</a> </li> <li class="toctree-l2"><a class="reference internal" href="../../technical/error-handling-resilience/">Error Handling &amp; Resilience</a> </li> </ul> </li> </ul> <p class="caption"><span class="caption-text">Service Availability</span></p> <ul> <li class="toctree-l1"><a class="reference internal" href="../../service-availability/context-and-scope/">Context and Scope</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../service-availability/quality-requirements/">Quality Requirements</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../service-availability/architecture-constraints/">Architecture Constraints</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../service-availability/availability-monitoring/">Availability Monitoring</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../service-availability/service-outage/">Error Handling</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../service-availability/rate-limiting-throttling/">Rate Limiting</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../service-availability/log-alerts/">Logging and Alerts</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../service-availability/testing-validation/">Testing and Validation</a> </li> </ul> <p class="caption"><span class="caption-text">Conversation Management</span></p> <ul> <li class="toctree-l1"><a class="reference internal" href="../../conversation/topic-detection/">Topic Detection</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../conversation/conversation-flow/">Conversation Flow</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../conversation/response-generation/">Response Generation</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../conversation/nlp-components/">NLP Components</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../conversation/markov-generation/">Markov Chain Text</a> </li> </ul> <p class="caption"><span class="caption-text">Image Processing</span></p> <ul> <li class="toctree-l1"><a class="reference internal" href="../../image-processing/overview/">Overview</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../image-processing/effects/">Effects and Filters</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../image-processing/svg-generation/">SVG Generation</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../image-processing/optimization/">Performance Optimization</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../image-processing/caching/">Caching Strategy</a> </li> </ul> <p class="caption"><span class="caption-text">Model Integration</span></p> <ul class="current"> <li class="toctree-l1"><a class="reference internal" href="../architecture/">Architecture</a> </li> <li class="toctree-l1"><a class="reference internal" href="../backend-selection/">Backend Selection</a> </li> <li class="toctree-l1 current"><a class="reference internal current" href="#">Capability Matrix</a> <ul class="current"> <li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a> </li> <li class="toctree-l2"><a class="reference internal" href="#purpose-and-function">Purpose and Function</a> </li> <li class="toctree-l2"><a class="reference internal" href="#core-structure">Core Structure</a> </li> <li class="toctree-l2"><a class="reference internal" href="#matrix-implementation">Matrix Implementation</a> </li> <li class="toctree-l2"><a class="reference internal" href="#capability-categories">Capability Categories</a> <ul> <li class="toctree-l3"><a class="reference internal" href="#general-capabilities">General Capabilities</a> </li> <li class="toctree-l3"><a class="reference internal" href="#specialized-capabilities">Specialized Capabilities</a> </li> <li class="toctree-l3"><a class="reference internal" href="#domain-knowledge">Domain Knowledge</a> </li> <li class="toctree-l3"><a class="reference internal" href="#language-capabilities">Language Capabilities</a> </li> <li class="toctree-l3"><a class="reference internal" href="#advanced-features">Advanced Features</a> </li> </ul> </li> <li class="toctree-l2"><a class="reference internal" href="#complete-capability-matrix">Complete Capability Matrix</a> </li> <li class="toctree-l2"><a class="reference internal" href="#model-specific-capabilities">Model-Specific Capabilities</a> <ul> <li class="toctree-l3"><a class="reference internal" href="#ollama-specific-capabilities">Ollama-Specific Capabilities</a> </li> </ul> </li> <li class="toctree-l2"><a class="reference internal" href="#usage-in-backend-selection">Usage in Backend Selection</a> </li> <li class="toctree-l2"><a class="reference internal" href="#capability-detection-from-queries">Capability Detection from Queries</a> </li> <li class="toctree-l2"><a class="reference internal" href="#extending-the-capability-matrix">Extending the Capability Matrix</a> </li> <li class="toctree-l2"><a class="reference internal" href="#dynamic-capability-adjustments">Dynamic Capability Adjustments</a> </li> <li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a> </li> <li class="toctree-l2"><a class="reference internal" href="#related-documentation">Related Documentation</a> </li> </ul> </li> <li class="toctree-l1"><a class="reference internal" href="../providers/">Provider Integration</a> </li> <li class="toctree-l1"><a class="reference internal" href="../configuration/">Model Configuration</a> </li> </ul> <p class="caption"><span class="caption-text">API Reference</span></p> <ul> <li class="toctree-l1"><a class="reference internal" href="../../api/getting-started/">Getting Started</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../api/routes/">Routes</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../api/oauth-configuration/">OAuth Configuration</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../api/request-response/">Request/Response</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../api/error-codes/">Error Codes</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../api/rate-limits/">Rate Limits</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../api/webhooks/">Webhook Integration</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../api/health-endpoints/">Health Endpoints</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../api/compliance/">Compliance</a> </li> </ul> <p class="caption"><span class="caption-text">Features</span></p> <ul> <li class="toctree-l1"><a class="reference internal" href="../../features/national-day/">Opossum National Day</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../features/easter-eggs/">Easter Eggs</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../features/special-events/">Special Events</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../features/background-stories/">Background Stories</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../features/service-vizualizations/">Service Visualizations</a> </li> </ul> <p class="caption"><span class="caption-text">About</span></p> <ul> <li class="toctree-l1"><a class="reference internal" href="../../about/history/">Project History</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../about/team/">Team</a> </li> <li class="toctree-l1"><a class="reference internal" href="../../about/roadmap/">Roadmap</a> </li> </ul> <p class="caption"><span class="caption-text">Infrastructure</span></p> <ul> <li class="toctree-l1"><a class="reference internal" href="../../infrastructure/optimization-strategies/">Optimization Strategies</a> </li> </ul> </div> </div> </nav> <section class="wy-nav-content-wrap" data-toggle="wy-nav-shift"> <nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation"> <i class="fa fa-bars" data-toggle="wy-nav-top"></i> <a href="../..">Opossum Search Documentation</a> </nav> <div class="wy-nav-content"> <div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation"> <ul class="wy-breadcrumbs"> <li><a aria-label="Docs" class="icon icon-home" href="../.."></a></li> <li class="breadcrumb-item">Model Integration</li> <li class="breadcrumb-item active">Capability Matrix</li> <li class="wy-breadcrumbs-aside"> </li> </ul> <hr/> </div> <div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main"> <div class="section" itemprop="articleBody"> <h1 id="capability-matrix">Capability Matrix<a class="headerlink" href="#capability-matrix" title="Permanent link">¶</a></h1> <h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">¶</a></h2> <p>The Capability Matrix is a foundational component of Opossum Search's model integration system that maps specific AI capabilities to available model backends. This matrix enables the dynamic selection of the most appropriate model for each request based on required capabilities, creating an intelligent routing system that optimizes for both performance and quality.</p> <h2 id="purpose-and-function">Purpose and Function<a class="headerlink" href="#purpose-and-function" title="Permanent link">¶</a></h2> <p>The Capability Matrix serves several critical functions:</p> <ol> <li><strong>Capability Mapping</strong>: Documents which capabilities each backend supports</li> <li><strong>Quality Scoring</strong>: Rates each backend's proficiency for specific capabilities</li> <li><strong>Selection Support</strong>: Provides data for the backend selection algorithm</li> <li><strong>Gap Analysis</strong>: Identifies capability gaps across the system</li> <li><strong>Version Tracking</strong>: Tracks capability changes across model versions</li> </ol> <h2 id="core-structure">Core Structure<a class="headerlink" href="#core-structure" title="Permanent link">¶</a></h2> <p>The Capability Matrix is implemented as a multi-dimensional mapping:</p> <pre class="mermaid"><code>graph LR
    A[Capability Matrix] --&gt; B{Backend}
    B --&gt; C[Gemini]
    B --&gt; D[Ollama]
    B --&gt; E[Transformers]

    C --&gt; F{Capabilities}
    D --&gt; F
    E --&gt; F

    F --&gt; G[text_understanding]
    F --&gt; H[image_understanding]
    F --&gt; I[code_generation]
    F --&gt; J[domain_knowledge]

    G --&gt; K{Scoring}
    H --&gt; K
    I --&gt; K
    J --&gt; K

    K --&gt; L[Proficiency Score]
    K --&gt; M[Confidence Level]
</code></pre> <h2 id="matrix-implementation">Matrix Implementation<a class="headerlink" href="#matrix-implementation" title="Permanent link">¶</a></h2> <p>The Capability Matrix is implemented as a nested dictionary structure:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CapabilityMatrix</span><span class="p">:</span>
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">    </span><span class="sd">"""Maps AI capabilities to model backends with quality scores"""</span>
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="c1"># Initialize the base matrix structure</span>
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span> <span class="o">=</span> <span class="p">{</span>
<a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a>            <span class="s1">'gemini'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_gemini_capabilities</span><span class="p">(),</span>
<a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a>            <span class="s1">'ollama'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_ollama_capabilities</span><span class="p">(),</span>
<a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a>            <span class="s1">'transformers'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_transformers_capabilities</span><span class="p">()</span>
<a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a>        <span class="p">}</span>
<a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a>
<a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_init_gemini_capabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">        </span><span class="sd">"""Initialize Gemini capabilities"""</span>
<a href="#__codelineno-0-14" id="__codelineno-0-14" name="__codelineno-0-14"></a>        <span class="k">return</span> <span class="p">{</span>
<a href="#__codelineno-0-15" id="__codelineno-0-15" name="__codelineno-0-15"></a>            <span class="c1"># General capabilities</span>
<a href="#__codelineno-0-16" id="__codelineno-0-16" name="__codelineno-0-16"></a>            <span class="s1">'text_understanding'</span><span class="p">:</span> <span class="mf">0.95</span><span class="p">,</span>
<a href="#__codelineno-0-17" id="__codelineno-0-17" name="__codelineno-0-17"></a>            <span class="s1">'text_generation'</span><span class="p">:</span> <span class="mf">0.94</span><span class="p">,</span>
<a href="#__codelineno-0-18" id="__codelineno-0-18" name="__codelineno-0-18"></a>            <span class="s1">'conversation'</span><span class="p">:</span> <span class="mf">0.92</span><span class="p">,</span>
<a href="#__codelineno-0-19" id="__codelineno-0-19" name="__codelineno-0-19"></a>            <span class="s1">'general_knowledge'</span><span class="p">:</span> <span class="mf">0.93</span><span class="p">,</span>
<a href="#__codelineno-0-20" id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a href="#__codelineno-0-21" id="__codelineno-0-21" name="__codelineno-0-21"></a>            <span class="c1"># Specialized capabilities</span>
<a href="#__codelineno-0-22" id="__codelineno-0-22" name="__codelineno-0-22"></a>            <span class="s1">'image_understanding'</span><span class="p">:</span> <span class="mf">0.90</span><span class="p">,</span>
<a href="#__codelineno-0-23" id="__codelineno-0-23" name="__codelineno-0-23"></a>            <span class="s1">'code_understanding'</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
<a href="#__codelineno-0-24" id="__codelineno-0-24" name="__codelineno-0-24"></a>            <span class="s1">'code_generation'</span><span class="p">:</span> <span class="mf">0.82</span><span class="p">,</span>
<a href="#__codelineno-0-25" id="__codelineno-0-25" name="__codelineno-0-25"></a>            <span class="s1">'reasoning'</span><span class="p">:</span> <span class="mf">0.88</span><span class="p">,</span>
<a href="#__codelineno-0-26" id="__codelineno-0-26" name="__codelineno-0-26"></a>            <span class="s1">'math'</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span>
<a href="#__codelineno-0-27" id="__codelineno-0-27" name="__codelineno-0-27"></a>            <span class="s1">'creative_writing'</span><span class="p">:</span> <span class="mf">0.88</span><span class="p">,</span>
<a href="#__codelineno-0-28" id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a href="#__codelineno-0-29" id="__codelineno-0-29" name="__codelineno-0-29"></a>            <span class="c1"># Domain knowledge</span>
<a href="#__codelineno-0-30" id="__codelineno-0-30" name="__codelineno-0-30"></a>            <span class="s1">'science'</span><span class="p">:</span> <span class="mf">0.86</span><span class="p">,</span>
<a href="#__codelineno-0-31" id="__codelineno-0-31" name="__codelineno-0-31"></a>            <span class="s1">'medicine'</span><span class="p">:</span> <span class="mf">0.80</span><span class="p">,</span>
<a href="#__codelineno-0-32" id="__codelineno-0-32" name="__codelineno-0-32"></a>            <span class="s1">'finance'</span><span class="p">:</span> <span class="mf">0.82</span><span class="p">,</span>
<a href="#__codelineno-0-33" id="__codelineno-0-33" name="__codelineno-0-33"></a>            <span class="s1">'legal'</span><span class="p">:</span> <span class="mf">0.77</span><span class="p">,</span>
<a href="#__codelineno-0-34" id="__codelineno-0-34" name="__codelineno-0-34"></a>            <span class="s1">'current_events'</span><span class="p">:</span> <span class="mf">0.70</span><span class="p">,</span>  <span class="c1"># Limited by training cutoff</span>
<a href="#__codelineno-0-35" id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a href="#__codelineno-0-36" id="__codelineno-0-36" name="__codelineno-0-36"></a>            <span class="c1"># Languages</span>
<a href="#__codelineno-0-37" id="__codelineno-0-37" name="__codelineno-0-37"></a>            <span class="s1">'multilingual'</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
<a href="#__codelineno-0-38" id="__codelineno-0-38" name="__codelineno-0-38"></a>            <span class="s1">'translation'</span><span class="p">:</span> <span class="mf">0.83</span><span class="p">,</span>
<a href="#__codelineno-0-39" id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a href="#__codelineno-0-40" id="__codelineno-0-40" name="__codelineno-0-40"></a>            <span class="c1"># Advanced features</span>
<a href="#__codelineno-0-41" id="__codelineno-0-41" name="__codelineno-0-41"></a>            <span class="s1">'multimodal'</span><span class="p">:</span> <span class="mf">0.88</span><span class="p">,</span>
<a href="#__codelineno-0-42" id="__codelineno-0-42" name="__codelineno-0-42"></a>            <span class="s1">'long_context'</span><span class="p">:</span> <span class="mf">0.80</span><span class="p">,</span>
<a href="#__codelineno-0-43" id="__codelineno-0-43" name="__codelineno-0-43"></a>            <span class="s1">'structured_output'</span><span class="p">:</span> <span class="mf">0.85</span>
<a href="#__codelineno-0-44" id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="p">}</span>
<a href="#__codelineno-0-45" id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a href="#__codelineno-0-46" id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_init_ollama_capabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a href="#__codelineno-0-47" id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="w">        </span><span class="sd">"""Initialize Ollama capabilities"""</span>
<a href="#__codelineno-0-48" id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="k">return</span> <span class="p">{</span>
<a href="#__codelineno-0-49" id="__codelineno-0-49" name="__codelineno-0-49"></a>            <span class="c1"># General capabilities</span>
<a href="#__codelineno-0-50" id="__codelineno-0-50" name="__codelineno-0-50"></a>            <span class="s1">'text_understanding'</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
<a href="#__codelineno-0-51" id="__codelineno-0-51" name="__codelineno-0-51"></a>            <span class="s1">'text_generation'</span><span class="p">:</span> <span class="mf">0.87</span><span class="p">,</span>
<a href="#__codelineno-0-52" id="__codelineno-0-52" name="__codelineno-0-52"></a>            <span class="s1">'conversation'</span><span class="p">:</span> <span class="mf">0.83</span><span class="p">,</span>
<a href="#__codelineno-0-53" id="__codelineno-0-53" name="__codelineno-0-53"></a>            <span class="s1">'general_knowledge'</span><span class="p">:</span> <span class="mf">0.84</span><span class="p">,</span>
<a href="#__codelineno-0-54" id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a href="#__codelineno-0-55" id="__codelineno-0-55" name="__codelineno-0-55"></a>            <span class="c1"># Specialized capabilities</span>
<a href="#__codelineno-0-56" id="__codelineno-0-56" name="__codelineno-0-56"></a>            <span class="s1">'image_understanding'</span><span class="p">:</span> <span class="mf">0.60</span><span class="p">,</span>  <span class="c1"># Limited in most models</span>
<a href="#__codelineno-0-57" id="__codelineno-0-57" name="__codelineno-0-57"></a>            <span class="s1">'code_understanding'</span><span class="p">:</span> <span class="mf">0.82</span><span class="p">,</span>  <span class="c1"># Good with CodeLlama</span>
<a href="#__codelineno-0-58" id="__codelineno-0-58" name="__codelineno-0-58"></a>            <span class="s1">'code_generation'</span><span class="p">:</span> <span class="mf">0.80</span><span class="p">,</span>  <span class="c1"># Good with CodeLlama</span>
<a href="#__codelineno-0-59" id="__codelineno-0-59" name="__codelineno-0-59"></a>            <span class="s1">'reasoning'</span><span class="p">:</span> <span class="mf">0.80</span><span class="p">,</span>
<a href="#__codelineno-0-60" id="__codelineno-0-60" name="__codelineno-0-60"></a>            <span class="s1">'math'</span><span class="p">:</span> <span class="mf">0.70</span><span class="p">,</span>
<a href="#__codelineno-0-61" id="__codelineno-0-61" name="__codelineno-0-61"></a>            <span class="s1">'creative_writing'</span><span class="p">:</span> <span class="mf">0.81</span><span class="p">,</span>
<a href="#__codelineno-0-62" id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a href="#__codelineno-0-63" id="__codelineno-0-63" name="__codelineno-0-63"></a>            <span class="c1"># Domain knowledge</span>
<a href="#__codelineno-0-64" id="__codelineno-0-64" name="__codelineno-0-64"></a>            <span class="s1">'science'</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span>
<a href="#__codelineno-0-65" id="__codelineno-0-65" name="__codelineno-0-65"></a>            <span class="s1">'medicine'</span><span class="p">:</span> <span class="mf">0.65</span><span class="p">,</span>
<a href="#__codelineno-0-66" id="__codelineno-0-66" name="__codelineno-0-66"></a>            <span class="s1">'finance'</span><span class="p">:</span> <span class="mf">0.70</span><span class="p">,</span>
<a href="#__codelineno-0-67" id="__codelineno-0-67" name="__codelineno-0-67"></a>            <span class="s1">'legal'</span><span class="p">:</span> <span class="mf">0.65</span><span class="p">,</span>
<a href="#__codelineno-0-68" id="__codelineno-0-68" name="__codelineno-0-68"></a>            <span class="s1">'current_events'</span><span class="p">:</span> <span class="mf">0.20</span><span class="p">,</span>  <span class="c1"># Very limited by training data</span>
<a href="#__codelineno-0-69" id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a href="#__codelineno-0-70" id="__codelineno-0-70" name="__codelineno-0-70"></a>            <span class="c1"># Languages</span>
<a href="#__codelineno-0-71" id="__codelineno-0-71" name="__codelineno-0-71"></a>            <span class="s1">'multilingual'</span><span class="p">:</span> <span class="mf">0.70</span><span class="p">,</span>
<a href="#__codelineno-0-72" id="__codelineno-0-72" name="__codelineno-0-72"></a>            <span class="s1">'translation'</span><span class="p">:</span> <span class="mf">0.65</span><span class="p">,</span>
<a href="#__codelineno-0-73" id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a href="#__codelineno-0-74" id="__codelineno-0-74" name="__codelineno-0-74"></a>            <span class="c1"># Advanced features</span>
<a href="#__codelineno-0-75" id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="s1">'multimodal'</span><span class="p">:</span> <span class="mf">0.30</span><span class="p">,</span>  <span class="c1"># Very limited</span>
<a href="#__codelineno-0-76" id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="s1">'long_context'</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span>  <span class="c1"># Varies by model</span>
<a href="#__codelineno-0-77" id="__codelineno-0-77" name="__codelineno-0-77"></a>            <span class="s1">'structured_output'</span><span class="p">:</span> <span class="mf">0.70</span>
<a href="#__codelineno-0-78" id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="p">}</span>
<a href="#__codelineno-0-79" id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a href="#__codelineno-0-80" id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_init_transformers_capabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a href="#__codelineno-0-81" id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="w">        </span><span class="sd">"""Initialize Transformers capabilities"""</span>
<a href="#__codelineno-0-82" id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="k">return</span> <span class="p">{</span>
<a href="#__codelineno-0-83" id="__codelineno-0-83" name="__codelineno-0-83"></a>            <span class="c1"># General capabilities</span>
<a href="#__codelineno-0-84" id="__codelineno-0-84" name="__codelineno-0-84"></a>            <span class="s1">'text_understanding'</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span>
<a href="#__codelineno-0-85" id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="s1">'text_generation'</span><span class="p">:</span> <span class="mf">0.72</span><span class="p">,</span>
<a href="#__codelineno-0-86" id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="s1">'conversation'</span><span class="p">:</span> <span class="mf">0.65</span><span class="p">,</span>
<a href="#__codelineno-0-87" id="__codelineno-0-87" name="__codelineno-0-87"></a>            <span class="s1">'general_knowledge'</span><span class="p">:</span> <span class="mf">0.70</span><span class="p">,</span>
<a href="#__codelineno-0-88" id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a href="#__codelineno-0-89" id="__codelineno-0-89" name="__codelineno-0-89"></a>            <span class="c1"># Specialized capabilities</span>
<a href="#__codelineno-0-90" id="__codelineno-0-90" name="__codelineno-0-90"></a>            <span class="s1">'image_understanding'</span><span class="p">:</span> <span class="mf">0.50</span><span class="p">,</span>  <span class="c1"># With appropriate models</span>
<a href="#__codelineno-0-91" id="__codelineno-0-91" name="__codelineno-0-91"></a>            <span class="s1">'code_understanding'</span><span class="p">:</span> <span class="mf">0.65</span><span class="p">,</span>
<a href="#__codelineno-0-92" id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="s1">'code_generation'</span><span class="p">:</span> <span class="mf">0.60</span><span class="p">,</span>
<a href="#__codelineno-0-93" id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="s1">'reasoning'</span><span class="p">:</span> <span class="mf">0.60</span><span class="p">,</span>
<a href="#__codelineno-0-94" id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="s1">'math'</span><span class="p">:</span> <span class="mf">0.55</span><span class="p">,</span>
<a href="#__codelineno-0-95" id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="s1">'creative_writing'</span><span class="p">:</span> <span class="mf">0.65</span><span class="p">,</span>
<a href="#__codelineno-0-96" id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a href="#__codelineno-0-97" id="__codelineno-0-97" name="__codelineno-0-97"></a>            <span class="c1"># Domain knowledge</span>
<a href="#__codelineno-0-98" id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="s1">'science'</span><span class="p">:</span> <span class="mf">0.60</span><span class="p">,</span>
<a href="#__codelineno-0-99" id="__codelineno-0-99" name="__codelineno-0-99"></a>            <span class="s1">'medicine'</span><span class="p">:</span> <span class="mf">0.50</span><span class="p">,</span>
<a href="#__codelineno-0-100" id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="s1">'finance'</span><span class="p">:</span> <span class="mf">0.55</span><span class="p">,</span>
<a href="#__codelineno-0-101" id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="s1">'legal'</span><span class="p">:</span> <span class="mf">0.50</span><span class="p">,</span>
<a href="#__codelineno-0-102" id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="s1">'current_events'</span><span class="p">:</span> <span class="mf">0.10</span><span class="p">,</span>  <span class="c1"># Extremely limited</span>
<a href="#__codelineno-0-103" id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a href="#__codelineno-0-104" id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="c1"># Languages</span>
<a href="#__codelineno-0-105" id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="s1">'multilingual'</span><span class="p">:</span> <span class="mf">0.60</span><span class="p">,</span>
<a href="#__codelineno-0-106" id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="s1">'translation'</span><span class="p">:</span> <span class="mf">0.65</span><span class="p">,</span>  <span class="c1"># With specialized models</span>
<a href="#__codelineno-0-107" id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a href="#__codelineno-0-108" id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="c1"># Advanced features</span>
<a href="#__codelineno-0-109" id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="s1">'multimodal'</span><span class="p">:</span> <span class="mf">0.20</span><span class="p">,</span>  <span class="c1"># Very limited</span>
<a href="#__codelineno-0-110" id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="s1">'long_context'</span><span class="p">:</span> <span class="mf">0.40</span><span class="p">,</span>  <span class="c1"># Very limited</span>
<a href="#__codelineno-0-111" id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="s1">'structured_output'</span><span class="p">:</span> <span class="mf">0.50</span>
<a href="#__codelineno-0-112" id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="p">}</span>
<a href="#__codelineno-0-113" id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a href="#__codelineno-0-114" id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">capability</span><span class="p">):</span>
<a href="#__codelineno-0-115" id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="w">        </span><span class="sd">"""Get the capability score for a specific backend"""</span>
<a href="#__codelineno-0-116" id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="k">if</span> <span class="n">backend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">:</span>
<a href="#__codelineno-0-117" id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="k">return</span> <span class="mf">0.0</span>
<a href="#__codelineno-0-118" id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a href="#__codelineno-0-119" id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="n">backend</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">capability</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<a href="#__codelineno-0-120" id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a href="#__codelineno-0-121" id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_capabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend</span><span class="p">):</span>
<a href="#__codelineno-0-122" id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">        </span><span class="sd">"""Get all capabilities supported by a backend"""</span>
<a href="#__codelineno-0-123" id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="k">if</span> <span class="n">backend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">:</span>
<a href="#__codelineno-0-124" id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="k">return</span> <span class="p">[]</span>
<a href="#__codelineno-0-125" id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a href="#__codelineno-0-126" id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="c1"># Return capabilities with non-zero scores</span>
<a href="#__codelineno-0-127" id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">cap</span> <span class="k">for</span> <span class="n">cap</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="n">backend</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> 
<a href="#__codelineno-0-128" id="__codelineno-0-128" name="__codelineno-0-128"></a>                <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span>
<a href="#__codelineno-0-129" id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a href="#__codelineno-0-130" id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_best_backend_for_capability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">capability</span><span class="p">):</span>
<a href="#__codelineno-0-131" id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="w">        </span><span class="sd">"""Get the best backend for a specific capability"""</span>
<a href="#__codelineno-0-132" id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">best_score</span> <span class="o">=</span> <span class="mf">0.0</span>
<a href="#__codelineno-0-133" id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="n">best_backend</span> <span class="o">=</span> <span class="kc">None</span>
<a href="#__codelineno-0-134" id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a href="#__codelineno-0-135" id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="k">for</span> <span class="n">backend</span><span class="p">,</span> <span class="n">capabilities</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a href="#__codelineno-0-136" id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="n">score</span> <span class="o">=</span> <span class="n">capabilities</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">capability</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<a href="#__codelineno-0-137" id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="n">best_score</span><span class="p">:</span>
<a href="#__codelineno-0-138" id="__codelineno-0-138" name="__codelineno-0-138"></a>                <span class="n">best_score</span> <span class="o">=</span> <span class="n">score</span>
<a href="#__codelineno-0-139" id="__codelineno-0-139" name="__codelineno-0-139"></a>                <span class="n">best_backend</span> <span class="o">=</span> <span class="n">backend</span>
<a href="#__codelineno-0-140" id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a href="#__codelineno-0-141" id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="k">return</span> <span class="n">best_backend</span><span class="p">,</span> <span class="n">best_score</span>
<a href="#__codelineno-0-142" id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a href="#__codelineno-0-143" id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">score_backend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">,</span> <span class="n">requirements</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a href="#__codelineno-0-144" id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="w">        </span><span class="sd">"""Score a backend based on capability requirements"""</span>
<a href="#__codelineno-0-145" id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">if</span> <span class="n">backend_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">:</span>
<a href="#__codelineno-0-146" id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="k">return</span> <span class="mf">0.0</span>
<a href="#__codelineno-0-147" id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a href="#__codelineno-0-148" id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="n">total_score</span> <span class="o">=</span> <span class="mf">0.0</span>
<a href="#__codelineno-0-149" id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="n">capabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="n">backend_name</span><span class="p">]</span>
<a href="#__codelineno-0-150" id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a href="#__codelineno-0-151" id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="k">for</span> <span class="n">requirement</span> <span class="ow">in</span> <span class="n">requirements</span><span class="p">:</span>
<a href="#__codelineno-0-152" id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="c1"># Get score for this capability</span>
<a href="#__codelineno-0-153" id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="n">score</span> <span class="o">=</span> <span class="n">capabilities</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">requirement</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<a href="#__codelineno-0-154" id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a href="#__codelineno-0-155" id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="c1"># Apply weighting based on importance</span>
<a href="#__codelineno-0-156" id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="n">weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_requirement_weight</span><span class="p">(</span><span class="n">requirement</span><span class="p">)</span>
<a href="#__codelineno-0-157" id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="n">total_score</span> <span class="o">+=</span> <span class="n">score</span> <span class="o">*</span> <span class="n">weight</span>
<a href="#__codelineno-0-158" id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a href="#__codelineno-0-159" id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="k">return</span> <span class="n">total_score</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">requirements</span><span class="p">)</span>
<a href="#__codelineno-0-160" id="__codelineno-0-160" name="__codelineno-0-160"></a>
<a href="#__codelineno-0-161" id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_requirement_weight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">requirement</span><span class="p">):</span>
<a href="#__codelineno-0-162" id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="w">        </span><span class="sd">"""Get weight for a requirement based on importance"""</span>
<a href="#__codelineno-0-163" id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="c1"># Critical capabilities have higher weights</span>
<a href="#__codelineno-0-164" id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">critical_capabilities</span> <span class="o">=</span> <span class="p">{</span>
<a href="#__codelineno-0-165" id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="s1">'image_understanding'</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>  <span class="c1"># Critical for image queries</span>
<a href="#__codelineno-0-166" id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="s1">'code_generation'</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">,</span>      <span class="c1"># Important for coding tasks</span>
<a href="#__codelineno-0-167" id="__codelineno-0-167" name="__codelineno-0-167"></a>            <span class="s1">'current_events'</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">,</span>       <span class="c1"># Important for news queries</span>
<a href="#__codelineno-0-168" id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="s1">'long_context'</span><span class="p">:</span> <span class="mf">1.2</span>          <span class="c1"># Important for context-heavy tasks</span>
<a href="#__codelineno-0-169" id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="p">}</span>
<a href="#__codelineno-0-170" id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a href="#__codelineno-0-171" id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="k">return</span> <span class="n">critical_capabilities</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">requirement</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</code></pre></div> <h2 id="capability-categories">Capability Categories<a class="headerlink" href="#capability-categories" title="Permanent link">¶</a></h2> <p>The matrix organizes capabilities into several categories:</p> <h3 id="general-capabilities">General Capabilities<a class="headerlink" href="#general-capabilities" title="Permanent link">¶</a></h3> <table> <thead> <tr> <th>Capability</th> <th>Description</th> <th>Importance</th> </tr> </thead> <tbody> <tr> <td><code>text_understanding</code></td> <td>Comprehension of natural language</td> <td>Critical</td> </tr> <tr> <td><code>text_generation</code></td> <td>Production of coherent text</td> <td>Critical</td> </tr> <tr> <td><code>conversation</code></td> <td>Multi-turn dialogue capabilities</td> <td>High</td> </tr> <tr> <td><code>general_knowledge</code></td> <td>Broad factual knowledge</td> <td>High</td> </tr> </tbody> </table> <h3 id="specialized-capabilities">Specialized Capabilities<a class="headerlink" href="#specialized-capabilities" title="Permanent link">¶</a></h3> <table> <thead> <tr> <th>Capability</th> <th>Description</th> <th>Importance</th> </tr> </thead> <tbody> <tr> <td><code>image_understanding</code></td> <td>Visual content analysis</td> <td>Critical for visual tasks</td> </tr> <tr> <td><code>code_understanding</code></td> <td>Source code comprehension</td> <td>Critical for code tasks</td> </tr> <tr> <td><code>code_generation</code></td> <td>Source code production</td> <td>Critical for code tasks</td> </tr> <tr> <td><code>reasoning</code></td> <td>Logical inference and problem-solving</td> <td>High</td> </tr> <tr> <td><code>math</code></td> <td>Mathematical computation and analysis</td> <td>Medium</td> </tr> <tr> <td><code>creative_writing</code></td> <td>Generation of creative content</td> <td>Medium</td> </tr> </tbody> </table> <h3 id="domain-knowledge">Domain Knowledge<a class="headerlink" href="#domain-knowledge" title="Permanent link">¶</a></h3> <table> <thead> <tr> <th>Capability</th> <th>Description</th> <th>Importance</th> </tr> </thead> <tbody> <tr> <td><code>science</code></td> <td>Scientific knowledge and reasoning</td> <td>Medium</td> </tr> <tr> <td><code>medicine</code></td> <td>Medical and health information</td> <td>Medium</td> </tr> <tr> <td><code>finance</code></td> <td>Financial and economic knowledge</td> <td>Medium</td> </tr> <tr> <td><code>legal</code></td> <td>Legal concepts and reasoning</td> <td>Medium</td> </tr> <tr> <td><code>current_events</code></td> <td>Recent world events</td> <td>Medium</td> </tr> </tbody> </table> <h3 id="language-capabilities">Language Capabilities<a class="headerlink" href="#language-capabilities" title="Permanent link">¶</a></h3> <table> <thead> <tr> <th>Capability</th> <th>Description</th> <th>Importance</th> </tr> </thead> <tbody> <tr> <td><code>multilingual</code></td> <td>Support for multiple languages</td> <td>Medium</td> </tr> <tr> <td><code>translation</code></td> <td>Language translation</td> <td>Medium</td> </tr> </tbody> </table> <h3 id="advanced-features">Advanced Features<a class="headerlink" href="#advanced-features" title="Permanent link">¶</a></h3> <table> <thead> <tr> <th>Capability</th> <th>Description</th> <th>Importance</th> </tr> </thead> <tbody> <tr> <td><code>multimodal</code></td> <td>Processing multiple input types</td> <td>High</td> </tr> <tr> <td><code>long_context</code></td> <td>Handling extended context windows</td> <td>High</td> </tr> <tr> <td><code>structured_output</code></td> <td>Producing structured data formats</td> <td>Medium</td> </tr> </tbody> </table> <h2 id="complete-capability-matrix">Complete Capability Matrix<a class="headerlink" href="#complete-capability-matrix" title="Permanent link">¶</a></h2> <p>The following table shows the complete capability scoring across all backends:</p> <table> <thead> <tr> <th>Capability</th> <th>Gemini</th> <th>Ollama</th> <th>Transformers</th> </tr> </thead> <tbody> <tr> <td><strong>General Capabilities</strong></td> <td></td> <td></td> <td></td> </tr> <tr> <td>text_understanding</td> <td>0.95</td> <td>0.85</td> <td>0.75</td> </tr> <tr> <td>text_generation</td> <td>0.94</td> <td>0.87</td> <td>0.72</td> </tr> <tr> <td>conversation</td> <td>0.92</td> <td>0.83</td> <td>0.65</td> </tr> <tr> <td>general_knowledge</td> <td>0.93</td> <td>0.84</td> <td>0.70</td> </tr> <tr> <td><strong>Specialized Capabilities</strong></td> <td></td> <td></td> <td></td> </tr> <tr> <td>image_understanding</td> <td>0.90</td> <td>0.60</td> <td>0.50</td> </tr> <tr> <td>code_understanding</td> <td>0.85</td> <td>0.82</td> <td>0.65</td> </tr> <tr> <td>code_generation</td> <td>0.82</td> <td>0.80</td> <td>0.60</td> </tr> <tr> <td>reasoning</td> <td>0.88</td> <td>0.80</td> <td>0.60</td> </tr> <tr> <td>math</td> <td>0.75</td> <td>0.70</td> <td>0.55</td> </tr> <tr> <td>creative_writing</td> <td>0.88</td> <td>0.81</td> <td>0.65</td> </tr> <tr> <td><strong>Domain Knowledge</strong></td> <td></td> <td></td> <td></td> </tr> <tr> <td>science</td> <td>0.86</td> <td>0.75</td> <td>0.60</td> </tr> <tr> <td>medicine</td> <td>0.80</td> <td>0.65</td> <td>0.50</td> </tr> <tr> <td>finance</td> <td>0.82</td> <td>0.70</td> <td>0.55</td> </tr> <tr> <td>legal</td> <td>0.77</td> <td>0.65</td> <td>0.50</td> </tr> <tr> <td>current_events</td> <td>0.70</td> <td>0.20</td> <td>0.10</td> </tr> <tr> <td><strong>Languages</strong></td> <td></td> <td></td> <td></td> </tr> <tr> <td>multilingual</td> <td>0.85</td> <td>0.70</td> <td>0.60</td> </tr> <tr> <td>translation</td> <td>0.83</td> <td>0.65</td> <td>0.65</td> </tr> <tr> <td><strong>Advanced Features</strong></td> <td></td> <td></td> <td></td> </tr> <tr> <td>multimodal</td> <td>0.88</td> <td>0.30</td> <td>0.20</td> </tr> <tr> <td>long_context</td> <td>0.80</td> <td>0.75</td> <td>0.40</td> </tr> <tr> <td>structured_output</td> <td>0.85</td> <td>0.70</td> <td>0.50</td> </tr> </tbody> </table> <h2 id="model-specific-capabilities">Model-Specific Capabilities<a class="headerlink" href="#model-specific-capabilities" title="Permanent link">¶</a></h2> <p>Some capabilities are specific to particular model configurations:</p> <h3 id="ollama-specific-capabilities">Ollama-Specific Capabilities<a class="headerlink" href="#ollama-specific-capabilities" title="Permanent link">¶</a></h3> <p>Ollama capabilities vary by the specific model loaded:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_ollama_model_specific_capabilities</span><span class="p">(</span><span class="n">model_name</span><span class="p">):</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="w">    </span><span class="sd">"""Get capability adjustments for specific Ollama models"""</span>
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a>    <span class="c1"># Model-specific capability adjustments</span>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a>    <span class="n">adjustments</span> <span class="o">=</span> <span class="p">{</span>
<a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a>        <span class="s1">'llama2'</span><span class="p">:</span> <span class="p">{</span>
<a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a>            <span class="s1">'reasoning'</span><span class="p">:</span> <span class="o">+</span><span class="mf">0.05</span><span class="p">,</span>
<a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a>            <span class="s1">'math'</span><span class="p">:</span> <span class="o">+</span><span class="mf">0.05</span>
<a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a>        <span class="p">},</span>
<a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a>        <span class="s1">'codellama'</span><span class="p">:</span> <span class="p">{</span>
<a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a>            <span class="s1">'code_understanding'</span><span class="p">:</span> <span class="o">+</span><span class="mf">0.10</span><span class="p">,</span>
<a href="#__codelineno-1-12" id="__codelineno-1-12" name="__codelineno-1-12"></a>            <span class="s1">'code_generation'</span><span class="p">:</span> <span class="o">+</span><span class="mf">0.15</span>
<a href="#__codelineno-1-13" id="__codelineno-1-13" name="__codelineno-1-13"></a>        <span class="p">},</span>
<a href="#__codelineno-1-14" id="__codelineno-1-14" name="__codelineno-1-14"></a>        <span class="s1">'mistral'</span><span class="p">:</span> <span class="p">{</span>
<a href="#__codelineno-1-15" id="__codelineno-1-15" name="__codelineno-1-15"></a>            <span class="s1">'text_understanding'</span><span class="p">:</span> <span class="o">+</span><span class="mf">0.05</span><span class="p">,</span>
<a href="#__codelineno-1-16" id="__codelineno-1-16" name="__codelineno-1-16"></a>            <span class="s1">'reasoning'</span><span class="p">:</span> <span class="o">+</span><span class="mf">0.07</span>
<a href="#__codelineno-1-17" id="__codelineno-1-17" name="__codelineno-1-17"></a>        <span class="p">},</span>
<a href="#__codelineno-1-18" id="__codelineno-1-18" name="__codelineno-1-18"></a>        <span class="s1">'vicuna'</span><span class="p">:</span> <span class="p">{</span>
<a href="#__codelineno-1-19" id="__codelineno-1-19" name="__codelineno-1-19"></a>            <span class="s1">'conversation'</span><span class="p">:</span> <span class="o">+</span><span class="mf">0.08</span><span class="p">,</span>
<a href="#__codelineno-1-20" id="__codelineno-1-20" name="__codelineno-1-20"></a>            <span class="s1">'creative_writing'</span><span class="p">:</span> <span class="o">+</span><span class="mf">0.05</span>
<a href="#__codelineno-1-21" id="__codelineno-1-21" name="__codelineno-1-21"></a>        <span class="p">},</span>
<a href="#__codelineno-1-22" id="__codelineno-1-22" name="__codelineno-1-22"></a>        <span class="s1">'orca-mini'</span><span class="p">:</span> <span class="p">{</span>
<a href="#__codelineno-1-23" id="__codelineno-1-23" name="__codelineno-1-23"></a>            <span class="s1">'instruction_following'</span><span class="p">:</span> <span class="o">+</span><span class="mf">0.10</span>
<a href="#__codelineno-1-24" id="__codelineno-1-24" name="__codelineno-1-24"></a>        <span class="p">}</span>
<a href="#__codelineno-1-25" id="__codelineno-1-25" name="__codelineno-1-25"></a>    <span class="p">}</span>
<a href="#__codelineno-1-26" id="__codelineno-1-26" name="__codelineno-1-26"></a>
<a href="#__codelineno-1-27" id="__codelineno-1-27" name="__codelineno-1-27"></a>    <span class="k">return</span> <span class="n">adjustments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="p">{})</span>
</code></pre></div> <h2 id="usage-in-backend-selection">Usage in Backend Selection<a class="headerlink" href="#usage-in-backend-selection" title="Permanent link">¶</a></h2> <p>The capability matrix is a key input to the backend selection process:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">select_optimal_backend</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">available_backends</span><span class="p">,</span> <span class="n">capability_matrix</span><span class="p">):</span>
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="w">    </span><span class="sd">"""Select the optimal backend based on request capabilities"""</span>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a>
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a>    <span class="c1"># Extract required capabilities from request</span>
<a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a>    <span class="n">required_capabilities</span> <span class="o">=</span> <span class="n">analyze_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a>
<a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a>    <span class="c1"># Score each available backend</span>
<a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a>    <span class="n">scores</span> <span class="o">=</span> <span class="p">{}</span>
<a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a>    <span class="k">for</span> <span class="n">backend_name</span> <span class="ow">in</span> <span class="n">available_backends</span><span class="p">:</span>
<a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a>        <span class="c1"># Calculate base capability score</span>
<a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a>        <span class="n">capability_score</span> <span class="o">=</span> <span class="mi">0</span>
<a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a>        <span class="k">for</span> <span class="n">capability</span> <span class="ow">in</span> <span class="n">required_capabilities</span><span class="p">:</span>
<a href="#__codelineno-2-13" id="__codelineno-2-13" name="__codelineno-2-13"></a>            <span class="n">score</span> <span class="o">=</span> <span class="n">capability_matrix</span><span class="o">.</span><span class="n">get_score</span><span class="p">(</span><span class="n">backend_name</span><span class="p">,</span> <span class="n">capability</span><span class="p">)</span>
<a href="#__codelineno-2-14" id="__codelineno-2-14" name="__codelineno-2-14"></a>            <span class="n">weight</span> <span class="o">=</span> <span class="n">get_capability_weight</span><span class="p">(</span><span class="n">capability</span><span class="p">)</span>
<a href="#__codelineno-2-15" id="__codelineno-2-15" name="__codelineno-2-15"></a>            <span class="n">capability_score</span> <span class="o">+=</span> <span class="n">score</span> <span class="o">*</span> <span class="n">weight</span>
<a href="#__codelineno-2-16" id="__codelineno-2-16" name="__codelineno-2-16"></a>
<a href="#__codelineno-2-17" id="__codelineno-2-17" name="__codelineno-2-17"></a>        <span class="c1"># Normalize score</span>
<a href="#__codelineno-2-18" id="__codelineno-2-18" name="__codelineno-2-18"></a>        <span class="k">if</span> <span class="n">required_capabilities</span><span class="p">:</span>
<a href="#__codelineno-2-19" id="__codelineno-2-19" name="__codelineno-2-19"></a>            <span class="n">capability_score</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">required_capabilities</span><span class="p">)</span>
<a href="#__codelineno-2-20" id="__codelineno-2-20" name="__codelineno-2-20"></a>
<a href="#__codelineno-2-21" id="__codelineno-2-21" name="__codelineno-2-21"></a>        <span class="c1"># Apply other factors (performance, cost, etc.)</span>
<a href="#__codelineno-2-22" id="__codelineno-2-22" name="__codelineno-2-22"></a>        <span class="n">adjusted_score</span> <span class="o">=</span> <span class="n">apply_scoring_factors</span><span class="p">(</span>
<a href="#__codelineno-2-23" id="__codelineno-2-23" name="__codelineno-2-23"></a>            <span class="n">backend_name</span><span class="p">,</span> 
<a href="#__codelineno-2-24" id="__codelineno-2-24" name="__codelineno-2-24"></a>            <span class="n">capability_score</span><span class="p">,</span>
<a href="#__codelineno-2-25" id="__codelineno-2-25" name="__codelineno-2-25"></a>            <span class="n">request</span>
<a href="#__codelineno-2-26" id="__codelineno-2-26" name="__codelineno-2-26"></a>        <span class="p">)</span>
<a href="#__codelineno-2-27" id="__codelineno-2-27" name="__codelineno-2-27"></a>
<a href="#__codelineno-2-28" id="__codelineno-2-28" name="__codelineno-2-28"></a>        <span class="n">scores</span><span class="p">[</span><span class="n">backend_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">adjusted_score</span>
<a href="#__codelineno-2-29" id="__codelineno-2-29" name="__codelineno-2-29"></a>
<a href="#__codelineno-2-30" id="__codelineno-2-30" name="__codelineno-2-30"></a>    <span class="c1"># Select highest scoring backend</span>
<a href="#__codelineno-2-31" id="__codelineno-2-31" name="__codelineno-2-31"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">scores</span><span class="p">:</span>
<a href="#__codelineno-2-32" id="__codelineno-2-32" name="__codelineno-2-32"></a>        <span class="k">return</span> <span class="n">DEFAULT_BACKEND</span>
<a href="#__codelineno-2-33" id="__codelineno-2-33" name="__codelineno-2-33"></a>
<a href="#__codelineno-2-34" id="__codelineno-2-34" name="__codelineno-2-34"></a>    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div> <h2 id="capability-detection-from-queries">Capability Detection from Queries<a class="headerlink" href="#capability-detection-from-queries" title="Permanent link">¶</a></h2> <p>The system detects required capabilities from queries:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">detect_capabilities_from_query</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">    </span><span class="sd">"""Detect required capabilities from a query"""</span>
<a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a>    <span class="n">capabilities</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'text_understanding'</span><span class="p">]</span>  <span class="c1"># Base capability</span>
<a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a>
<a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a>    <span class="c1"># Check for image content</span>
<a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a>    <span class="k">if</span> <span class="n">contains_images</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
<a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a>        <span class="n">capabilities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'image_understanding'</span><span class="p">)</span>
<a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a>
<a href="#__codelineno-3-9" id="__codelineno-3-9" name="__codelineno-3-9"></a>        <span class="c1"># Detect specific image types</span>
<a href="#__codelineno-3-10" id="__codelineno-3-10" name="__codelineno-3-10"></a>        <span class="k">if</span> <span class="n">detect_chart</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<a href="#__codelineno-3-11" id="__codelineno-3-11" name="__codelineno-3-11"></a>            <span class="n">capabilities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'chart_analysis'</span><span class="p">)</span>
<a href="#__codelineno-3-12" id="__codelineno-3-12" name="__codelineno-3-12"></a>
<a href="#__codelineno-3-13" id="__codelineno-3-13" name="__codelineno-3-13"></a>        <span class="k">if</span> <span class="n">detect_document</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<a href="#__codelineno-3-14" id="__codelineno-3-14" name="__codelineno-3-14"></a>            <span class="n">capabilities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'document_analysis'</span><span class="p">)</span>
<a href="#__codelineno-3-15" id="__codelineno-3-15" name="__codelineno-3-15"></a>
<a href="#__codelineno-3-16" id="__codelineno-3-16" name="__codelineno-3-16"></a>    <span class="c1"># Check for code content</span>
<a href="#__codelineno-3-17" id="__codelineno-3-17" name="__codelineno-3-17"></a>    <span class="k">if</span> <span class="n">contains_code</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
<a href="#__codelineno-3-18" id="__codelineno-3-18" name="__codelineno-3-18"></a>        <span class="n">capabilities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'code_understanding'</span><span class="p">)</span>
<a href="#__codelineno-3-19" id="__codelineno-3-19" name="__codelineno-3-19"></a>
<a href="#__codelineno-3-20" id="__codelineno-3-20" name="__codelineno-3-20"></a>        <span class="c1"># Detect programming language</span>
<a href="#__codelineno-3-21" id="__codelineno-3-21" name="__codelineno-3-21"></a>        <span class="n">language</span> <span class="o">=</span> <span class="n">detect_language</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a href="#__codelineno-3-22" id="__codelineno-3-22" name="__codelineno-3-22"></a>        <span class="k">if</span> <span class="n">language</span><span class="p">:</span>
<a href="#__codelineno-3-23" id="__codelineno-3-23" name="__codelineno-3-23"></a>            <span class="n">capabilities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">language</span><span class="si">}</span><span class="s1">_expertise'</span><span class="p">)</span>
<a href="#__codelineno-3-24" id="__codelineno-3-24" name="__codelineno-3-24"></a>
<a href="#__codelineno-3-25" id="__codelineno-3-25" name="__codelineno-3-25"></a>    <span class="c1"># Detect domain-specific needs</span>
<a href="#__codelineno-3-26" id="__codelineno-3-26" name="__codelineno-3-26"></a>    <span class="n">domain</span> <span class="o">=</span> <span class="n">detect_domain</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a href="#__codelineno-3-27" id="__codelineno-3-27" name="__codelineno-3-27"></a>    <span class="k">if</span> <span class="n">domain</span><span class="p">:</span>
<a href="#__codelineno-3-28" id="__codelineno-3-28" name="__codelineno-3-28"></a>        <span class="n">capabilities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">domain</span><span class="si">}</span><span class="s1">_knowledge'</span><span class="p">)</span>
<a href="#__codelineno-3-29" id="__codelineno-3-29" name="__codelineno-3-29"></a>
<a href="#__codelineno-3-30" id="__codelineno-3-30" name="__codelineno-3-30"></a>    <span class="c1"># Check for specific tasks</span>
<a href="#__codelineno-3-31" id="__codelineno-3-31" name="__codelineno-3-31"></a>    <span class="k">if</span> <span class="n">is_creative_task</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
<a href="#__codelineno-3-32" id="__codelineno-3-32" name="__codelineno-3-32"></a>        <span class="n">capabilities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'creative_writing'</span><span class="p">)</span>
<a href="#__codelineno-3-33" id="__codelineno-3-33" name="__codelineno-3-33"></a>
<a href="#__codelineno-3-34" id="__codelineno-3-34" name="__codelineno-3-34"></a>    <span class="k">if</span> <span class="n">is_reasoning_task</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
<a href="#__codelineno-3-35" id="__codelineno-3-35" name="__codelineno-3-35"></a>        <span class="n">capabilities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'reasoning'</span><span class="p">)</span>
<a href="#__codelineno-3-36" id="__codelineno-3-36" name="__codelineno-3-36"></a>
<a href="#__codelineno-3-37" id="__codelineno-3-37" name="__codelineno-3-37"></a>    <span class="k">if</span> <span class="n">is_math_task</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
<a href="#__codelineno-3-38" id="__codelineno-3-38" name="__codelineno-3-38"></a>        <span class="n">capabilities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'math'</span><span class="p">)</span>
<a href="#__codelineno-3-39" id="__codelineno-3-39" name="__codelineno-3-39"></a>
<a href="#__codelineno-3-40" id="__codelineno-3-40" name="__codelineno-3-40"></a>    <span class="k">return</span> <span class="n">capabilities</span>
</code></pre></div> <h2 id="extending-the-capability-matrix">Extending the Capability Matrix<a class="headerlink" href="#extending-the-capability-matrix" title="Permanent link">¶</a></h2> <p>The capability matrix can be extended with new capabilities:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">extend_capability_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">new_capabilities</span><span class="p">):</span>
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w">    </span><span class="sd">"""Add new capabilities to the capability matrix"""</span>
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a>
<a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a>    <span class="k">for</span> <span class="n">capability_name</span><span class="p">,</span> <span class="n">capability_info</span> <span class="ow">in</span> <span class="n">new_capabilities</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a>        <span class="c1"># Add to each backend with default scores</span>
<a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a>        <span class="k">for</span> <span class="n">backend</span> <span class="ow">in</span> <span class="n">matrix</span><span class="o">.</span><span class="n">matrix</span><span class="p">:</span>
<a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a>            <span class="n">default_score</span> <span class="o">=</span> <span class="n">capability_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'default_scores'</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a>            <span class="n">matrix</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="n">backend</span><span class="p">][</span><span class="n">capability_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_score</span>
<a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a>
<a href="#__codelineno-4-10" id="__codelineno-4-10" name="__codelineno-4-10"></a>    <span class="k">return</span> <span class="n">matrix</span>
</code></pre></div> <h2 id="dynamic-capability-adjustments">Dynamic Capability Adjustments<a class="headerlink" href="#dynamic-capability-adjustments" title="Permanent link">¶</a></h2> <p>The system can dynamically adjust capability scores based on performance feedback:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">adjust_capability_scores</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">feedback_data</span><span class="p">):</span>
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="w">    </span><span class="sd">"""Adjust capability scores based on performance feedback"""</span>
<a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a>
<a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">feedback_data</span><span class="p">:</span>
<a href="#__codelineno-5-5" id="__codelineno-5-5" name="__codelineno-5-5"></a>        <span class="n">backend</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">'backend'</span><span class="p">]</span>
<a href="#__codelineno-5-6" id="__codelineno-5-6" name="__codelineno-5-6"></a>        <span class="n">capability</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">'capability'</span><span class="p">]</span>
<a href="#__codelineno-5-7" id="__codelineno-5-7" name="__codelineno-5-7"></a>        <span class="n">success</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">'success'</span><span class="p">]</span>
<a href="#__codelineno-5-8" id="__codelineno-5-8" name="__codelineno-5-8"></a>
<a href="#__codelineno-5-9" id="__codelineno-5-9" name="__codelineno-5-9"></a>        <span class="k">if</span> <span class="n">backend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">matrix</span><span class="o">.</span><span class="n">matrix</span><span class="p">:</span>
<a href="#__codelineno-5-10" id="__codelineno-5-10" name="__codelineno-5-10"></a>            <span class="k">continue</span>
<a href="#__codelineno-5-11" id="__codelineno-5-11" name="__codelineno-5-11"></a>
<a href="#__codelineno-5-12" id="__codelineno-5-12" name="__codelineno-5-12"></a>        <span class="k">if</span> <span class="n">capability</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">matrix</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="n">backend</span><span class="p">]:</span>
<a href="#__codelineno-5-13" id="__codelineno-5-13" name="__codelineno-5-13"></a>            <span class="k">continue</span>
<a href="#__codelineno-5-14" id="__codelineno-5-14" name="__codelineno-5-14"></a>
<a href="#__codelineno-5-15" id="__codelineno-5-15" name="__codelineno-5-15"></a>        <span class="c1"># Get current score</span>
<a href="#__codelineno-5-16" id="__codelineno-5-16" name="__codelineno-5-16"></a>        <span class="n">current_score</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="n">backend</span><span class="p">][</span><span class="n">capability</span><span class="p">]</span>
<a href="#__codelineno-5-17" id="__codelineno-5-17" name="__codelineno-5-17"></a>
<a href="#__codelineno-5-18" id="__codelineno-5-18" name="__codelineno-5-18"></a>        <span class="c1"># Adjust score based on success/failure</span>
<a href="#__codelineno-5-19" id="__codelineno-5-19" name="__codelineno-5-19"></a>        <span class="n">adjustment</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="k">if</span> <span class="n">success</span> <span class="k">else</span> <span class="o">-</span><span class="mf">0.02</span>
<a href="#__codelineno-5-20" id="__codelineno-5-20" name="__codelineno-5-20"></a>        <span class="n">new_score</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">current_score</span> <span class="o">+</span> <span class="n">adjustment</span><span class="p">))</span>
<a href="#__codelineno-5-21" id="__codelineno-5-21" name="__codelineno-5-21"></a>
<a href="#__codelineno-5-22" id="__codelineno-5-22" name="__codelineno-5-22"></a>        <span class="c1"># Update score</span>
<a href="#__codelineno-5-23" id="__codelineno-5-23" name="__codelineno-5-23"></a>        <span class="n">matrix</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="n">backend</span><span class="p">][</span><span class="n">capability</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_score</span>
<a href="#__codelineno-5-24" id="__codelineno-5-24" name="__codelineno-5-24"></a>
<a href="#__codelineno-5-25" id="__codelineno-5-25" name="__codelineno-5-25"></a>    <span class="k">return</span> <span class="n">matrix</span>
</code></pre></div> <h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">¶</a></h2> <p>The capability matrix can be configured through settings:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="nt">capability_matrix</span><span class="p">:</span>
<a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="w">  </span><span class="c1"># Enable dynamic adjustments based on performance</span>
<a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">  </span><span class="nt">enable_dynamic_adjustment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a>
<a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">  </span><span class="c1"># Minimum score threshold for capability support</span>
<a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="w">  </span><span class="nt">minimum_score_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.2</span>
<a href="#__codelineno-6-7" id="__codelineno-6-7" name="__codelineno-6-7"></a>
<a href="#__codelineno-6-8" id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="w">  </span><span class="c1"># Custom capability weights</span>
<a href="#__codelineno-6-9" id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="w">  </span><span class="nt">capability_weights</span><span class="p">:</span>
<a href="#__codelineno-6-10" id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="w">    </span><span class="nt">image_understanding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.5</span>
<a href="#__codelineno-6-11" id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="w">    </span><span class="nt">code_generation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.3</span>
<a href="#__codelineno-6-12" id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="w">    </span><span class="nt">reasoning</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.2</span>
<a href="#__codelineno-6-13" id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="w">    </span><span class="nt">math</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.1</span>
<a href="#__codelineno-6-14" id="__codelineno-6-14" name="__codelineno-6-14"></a>
<a href="#__codelineno-6-15" id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="w">  </span><span class="c1"># Override default scores</span>
<a href="#__codelineno-6-16" id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="w">  </span><span class="nt">score_overrides</span><span class="p">:</span>
<a href="#__codelineno-6-17" id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="w">    </span><span class="nt">gemini</span><span class="p">:</span>
<a href="#__codelineno-6-18" id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="w">      </span><span class="nt">math</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.85</span><span class="w">  </span><span class="c1"># Override math score for Gemini</span>
<a href="#__codelineno-6-19" id="__codelineno-6-19" name="__codelineno-6-19"></a><span class="w">    </span><span class="nt">ollama</span><span class="p">:</span>
<a href="#__codelineno-6-20" id="__codelineno-6-20" name="__codelineno-6-20"></a><span class="w">      </span><span class="nt">code_understanding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.90</span><span class="w">  </span><span class="c1"># Override for CodeLlama model</span>
</code></pre></div> <h2 id="related-documentation">Related Documentation<a class="headerlink" href="#related-documentation" title="Permanent link">¶</a></h2> <ul> <li>Model Integration Architecture</li> <li>Backend Selection</li> <li>Provider Integration</li> <li>Model Configuration</li> <li>Service Availability</li> </ul> </div> </div><footer> <div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation"> <a class="btn btn-neutral float-left" href="../backend-selection/" title="Backend Selection"><span class="icon icon-circle-arrow-left"></span> Previous</a> <a class="btn btn-neutral float-right" href="../providers/" title="Provider Integration">Next <span class="icon icon-circle-arrow-right"></span></a> </div> <hr/> <div role="contentinfo"> <!-- Copyright etc --> </div> Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. </footer> </div> </div> </section> </div> <div aria-label="Versions" class="rst-versions" role="note"> <span class="rst-current-version" data-toggle="rst-current-version"> <span><a href="../backend-selection/" style="color: #fcfcfc">« Previous</a></span> <span><a href="../providers/" style="color: #fcfcfc">Next »</a></span> </span> </div> <script src="../../js/jquery-3.6.0.min.js"></script> <script>var base_url = "../..";</script> <script src="../../js/theme_extra.js"></script> <script src="../../js/theme.js"></script> <script src="../../search/main.js"></script> <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script> <script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
window.mermaidConfig = {default: {
    startOnLoad: false
}};</script></body> </html> 