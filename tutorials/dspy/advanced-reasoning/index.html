<!DOCTYPE html><html class=writer-html5 lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content=bebo><link rel="shortcut icon" href=../../../img/favicon.ico><title>Advanced Reasoning - Opossum Search Documentation</title><link rel=stylesheet href=../../../css/theme.css><link rel=stylesheet href=../../../css/theme_extra.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css><link href=../../../assets/_mkdocstrings.css rel=stylesheet><link href=../../../stylesheets/extra.css rel=stylesheet><script>
        // Current page data
        var mkdocs_page_name = "Advanced Reasoning";
        var mkdocs_page_input_path = "tutorials\\dspy\\advanced-reasoning.md";
        var mkdocs_page_url = null;
      </script><!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]--><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js></script><script>hljs.highlightAll();</script></head> <body class=wy-body-for-nav role=document> <div class=wy-grid-for-nav> <nav data-toggle=wy-nav-shift class="wy-nav-side stickynav"> <div class=wy-side-scroll> <div class=wy-side-nav-search> <a href=../../.. class="icon icon-home"> Opossum Search Documentation </a><div role=search> <form id=rtd-search-form class=wy-form action=../../../search.html method=get> <input type=text name=q placeholder="Search docs" aria-label="Search docs" title="Type search term here"> </form> </div> </div> <div class="wy-menu wy-menu-vertical" data-spy=affix role=navigation aria-label="Navigation menu"> <ul> <li class=toctree-l1><a class="reference internal" href=../../..>Home</a> </li> </ul> <p class=caption><span class=caption-text>Getting Started</span></p> <ul> <li class=toctree-l1><a href=../../../technical/getting-started/ class="reference internal">First Steps</a> </li> <li class=toctree-l1><a href=../../../technical/system-architecture-overview/ class="reference internal">System Overview</a> </li> <li class=toctree-l1><a href=../../../api/getting-started/ class="reference internal">API Reference</a> </li> <li class=toctree-l1><a href=../../../technical/devops-guide/ class="reference internal">Developer Quickstart</a> </li> </ul> <p class=caption><span class=caption-text>Core Components</span></p> <ul> <li class=toctree-l1><a class="reference internal">Architecture</a> <ul> <li class=toctree-l2><a href=../../../technical/system-architecture-overview/ class="reference internal">System Overview</a> </li> <li class=toctree-l2><a href=../../../technical/mcp-architecture/ class="reference internal">Model Context Protocol (MCP)</a> </li> <li class=toctree-l2><a href=../../../technical/graphql-api/ class="reference internal">GraphQL API</a> </li> <li class=toctree-l2><a href=../../../technical/security-model/ class="reference internal">Security Model</a> </li> <li class=toctree-l2><a href=../../../technical/prompt-management/ class="reference internal">Prompt Management</a> </li> </ul> </li> <li class=toctree-l1><a class="reference internal">Model Integration</a> <ul> <li class=toctree-l2><a href=../../../model-integration/architecture/ class="reference internal">Architecture</a> </li> <li class=toctree-l2><a href=../../../model-integration/backend-selection/ class="reference internal">Backend Selection</a> </li> <li class=toctree-l2><a href=../../../model-integration/capability-matrix/ class="reference internal">Capability Matrix</a> </li> <li class=toctree-l2><a href=../../../model-integration/providers/ class="reference internal">Provider Integration</a> </li> <li class=toctree-l2><a href=../../../model-integration/configuration/ class="reference internal">Configuration</a> </li> <li class=toctree-l2><a href=../../../technical/hybrid-model-selection/ class="reference internal">Hybrid Selection</a> </li> <li class=toctree-l2><a href=../../../technical/prompt-management/ class="reference internal">Prompt Management</a> </li> <li class=toctree-l2><a href=../../../model-integration/dspy-integration/ class="reference internal">DSPy Integration</a> </li> <li class=toctree-l2><a href=../../../model-integration/dspy-technical/ class="reference internal">DSPy Technical Implementation</a> </li> <li class=toctree-l2><a href=../../../model-integration/dspy-examples/ class="reference internal">DSPy Usage Examples</a> </li> <li class=toctree-l2><a href=../../../model-integration/dspy-metrics/ class="reference internal">DSPy Metrics & Performance</a> </li> </ul> </li> <li class=toctree-l1><a class="reference internal">Service Availability</a> <ul> <li class=toctree-l2><a href=../../../service-availability/context-and-scope/ class="reference internal">Context and Scope</a> </li> <li class=toctree-l2><a href=../../../service-availability/quality-requirements/ class="reference internal">Quality Requirements</a> </li> <li class=toctree-l2><a href=../../../service-availability/architecture-constraints/ class="reference internal">Architecture Constraints</a> </li> <li class=toctree-l2><a href=../../../service-availability/availability-monitoring/ class="reference internal">Availability Monitoring</a> </li> <li class=toctree-l2><a href=../../../service-availability/service-outage/ class="reference internal">Error Handling</a> </li> </ul> </li> <li class=toctree-l1><a class="reference internal">Resilience Patterns</a> <ul> <li class=toctree-l2><a href=../../../technical/resilience-patterns/ class="reference internal">Core Strategies</a> </li> <li class=toctree-l2><a href=../../../technical/error-handling-resilience/ class="reference internal">Error Handling</a> </li> <li class=toctree-l2><a href=../../../service-availability/rate-limiting-throttling/ class="reference internal">Rate Limiting</a> </li> <li class=toctree-l2><a href=../../../service-availability/log-alerts/ class="reference internal">Logging and Alerts</a> </li> <li class=toctree-l2><a href=../../../service-availability/testing-validation/ class="reference internal">Testing and Validation</a> </li> </ul> </li> </ul> <p class=caption><span class=caption-text>Features</span></p> <ul> <li class=toctree-l1><a class="reference internal">Conversation</a> <ul> <li class=toctree-l2><a href=../../../conversation/topic-detection/ class="reference internal">Topic Detection</a> </li> <li class=toctree-l2><a href=../../../conversation/conversation-flow/ class="reference internal">Conversation Flow</a> </li> <li class=toctree-l2><a href=../../../conversation/response-generation/ class="reference internal">Response Generation</a> </li> <li class=toctree-l2><a href=../../../conversation/nlp-components/ class="reference internal">NLP Components</a> </li> <li class=toctree-l2><a href=../../../conversation/markov-generation/ class="reference internal">Markov Generation</a> </li> </ul> </li> <li class=toctree-l1><a class="reference internal">Image Processing</a> <ul> <li class=toctree-l2><a href=../../../image-processing/overview/ class="reference internal">Overview</a> </li> <li class=toctree-l2><a href=../../../image-processing/effects/ class="reference internal">Effects and Filters</a> </li> <li class=toctree-l2><a href=../../../image-processing/svg-generation/ class="reference internal">SVG Generation</a> </li> <li class=toctree-l2><a href=../../../image-processing/optimization/ class="reference internal">Performance Optimization</a> </li> <li class=toctree-l2><a href=../../../image-processing/caching/ class="reference internal">Caching Strategy</a> </li> </ul> </li> <li class=toctree-l1><a class="reference internal">Visualizations & Fun</a> <ul> <li class=toctree-l2><a href=../../../features/service-vizualizations/ class="reference internal">Service Visualizations</a> </li> <li class=toctree-l2><a href=../../../features/national-day/ class="reference internal">National Opossum Day</a> </li> <li class=toctree-l2><a href=../../../features/opossum-xenzia/ class="reference internal">Opossum Xenzia</a> </li> <li class=toctree-l2><a href=../../../features/easter-eggs/ class="reference internal">Easter Eggs</a> </li> <li class=toctree-l2><a href=../../../features/special-events/ class="reference internal">Special Events</a> </li> <li class=toctree-l2><a href=../../../features/background-stories/ class="reference internal">Background Stories</a> </li> </ul> </li> </ul> <p class=caption><span class=caption-text>Technical Reference</span></p> <ul class=current> <li class=toctree-l1><a class="reference internal">Infrastructure</a> <ul> <li class=toctree-l2><a href=../../../technical/redis-caching-architecture/ class="reference internal">Redis Caching</a> </li> <li class=toctree-l2><a href=../../../technical/image-processing-pipeline/ class="reference internal">Image Pipeline</a> </li> <li class=toctree-l2><a href=../../../technical/opentelemetry-integration/ class="reference internal">OpenTelemetry</a> </li> <li class=toctree-l2><a href=../../../technical/svg-markup/ class="reference internal">SVG Markup</a> </li> <li class=toctree-l2><a href=../../../technical/bot-user-simulation/ class="reference internal">Bot User Simulation</a> </li> <li class=toctree-l2><a href=../../../infrastructure/optimization-strategies/ class="reference internal">Optimization Strategies</a> </li> <li class=toctree-l2><a href=../../../infrastructure/pipeline-optimization/ class="reference internal">Pipeline Optimization</a> </li> <li class=toctree-l2><a href=../../../infrastructure/constraint-mapping/ class="reference internal">Constraint Mapping</a> </li> </ul> </li> <li class=toctree-l1><a class="reference internal">API Documentation</a> <ul> <li class=toctree-l2><a href=../../../api/routes/ class="reference internal">Routes</a> </li> <li class=toctree-l2><a href=../../../api/request-response/ class="reference internal">Request/Response</a> </li> <li class=toctree-l2><a href=../../../api/oauth-configuration/ class="reference internal">OAuth Configuration</a> </li> <li class=toctree-l2><a href=../../../api/error-codes/ class="reference internal">Error Codes</a> </li> <li class=toctree-l2><a href=../../../api/rate-limits/ class="reference internal">Rate Limits</a> </li> <li class=toctree-l2><a href=../../../api/webhooks/ class="reference internal">Webhook Integration</a> </li> <li class=toctree-l2><a href=../../../api/health-endpoints/ class="reference internal">Health Endpoints</a> </li> <li class=toctree-l2><a href=../../../api/compliance/ class="reference internal">Compliance</a> </li> </ul> </li> <li class="toctree-l1 current"><a class="reference internal current">DSPy Tutorials</a> <ul class=current> <li class=toctree-l2><a href=../getting-started/ class="reference internal">Getting Started with DSPy</a> </li> <li class=toctree-l2><a href=../optimizing-prompts/ class="reference internal">Optimizing Prompts</a> </li> <li class=toctree-l2><a href=../building-pipelines/ class="reference internal">Building Pipelines</a> </li> <li class="toctree-l2 current"><a class="reference internal current" href=#>Advanced Reasoning</a> <ul class=current> <li class=toctree-l3><a class="reference internal" href=#why-advanced-reasoning-in-opossum>Why Advanced Reasoning in Opossum?</a> </li> <li class=toctree-l3><a class="reference internal" href=#key-dspy-modules-for-reasoning>Key DSPy Modules for Reasoning</a> </li> <li class=toctree-l3><a class="reference internal" href=#example-chain-of-thought-for-comparison>Example: Chain of Thought for Comparison</a> </li> <li class=toctree-l3><a class="reference internal" href=#example-react-for-tool-use>Example: ReAct for Tool Use</a> </li> <li class=toctree-l3><a class="reference internal" href=#combining-and-optimizing-reasoning-modules>Combining and Optimizing Reasoning Modules</a> </li> <li class=toctree-l3><a class="reference internal" href=#integration-in-opossum-search>Integration in Opossum Search</a> </li> <li class=toctree-l3><a class="reference internal" href=#conclusion>Conclusion</a> </li> </ul> </li> </ul> </li> </ul> <p class=caption><span class=caption-text>About</span></p> <ul> <li class=toctree-l1><a href=../../../about/history/ class="reference internal">Project History</a> </li> <li class=toctree-l1><a href=../../../about/opossumial-way/ class="reference internal">The Opossumial Way</a> </li> <li class=toctree-l1><a href=../../../about/team/ class="reference internal">Team</a> </li> <li class=toctree-l1><a href=../../../about/roadmap-vision/ class="reference internal">Roadmap & Vision</a> </li> </ul> </div> </div> </nav> <section data-toggle=wy-nav-shift class=wy-nav-content-wrap> <nav class=wy-nav-top role=navigation aria-label="Mobile navigation menu"> <i data-toggle=wy-nav-top class="fa fa-bars"></i> <a href=../../..>Opossum Search Documentation</a> </nav> <div class=wy-nav-content> <div class=rst-content><div role=navigation aria-label="breadcrumbs navigation"> <ul class=wy-breadcrumbs> <li><a href=../../.. class="icon icon-home" aria-label=Docs></a></li> <li class=breadcrumb-item>Technical Reference</li> <li class=breadcrumb-item>DSPy Tutorials</li> <li class="breadcrumb-item active">Advanced Reasoning</li> <li class=wy-breadcrumbs-aside> </li> </ul> <hr> </div> <div role=main class=document itemscope=itemscope itemtype=http://schema.org/Article> <div class=section itemprop=articleBody> <h1 id=advanced-reasoning-with-dspy>Advanced Reasoning with DSPy<a class=headerlink href=#advanced-reasoning-with-dspy title="Permanent link">&para;</a></h1> <p>Having covered the basics of DSPy modules in <a href=../getting-started/ >Getting Started</a> and how to optimize them in <a href=../optimizing-prompts/ >Optimizing Prompts</a>, we now turn to more complex reasoning tasks. DSPy provides powerful modules that enable language models (LMs) to perform multi-step reasoning, use tools, and tackle problems that require more than a simple input-output transformation.</p> <p>Within Opossum Search, these advanced techniques can enhance the system's ability to answer complex queries, compare concepts, synthesize information, and potentially interact with other internal tools or knowledge bases.</p> <h2 id=why-advanced-reasoning-in-opossum>Why Advanced Reasoning in Opossum?<a class=headerlink href=#why-advanced-reasoning-in-opossum title="Permanent link">&para;</a></h2> <ul> <li><strong>Deeper Understanding:</strong> Answer "why" and "how" questions that require step-by-step thinking, aligning with Opossum's goal of providing accurate, detailed information.</li> <li><strong>Comparative Analysis:</strong> Enable comparisons between concepts (e.g., "Compare opossums to raccoons," a query type mentioned in #<code>docs\technical\bot-user-simulation.md</code>).</li> <li><strong>Tool Use &amp; Grounding:</strong> Allow the LM to potentially use internal Opossum tools (like specific knowledge retrieval functions, or even aspects of the <a href=c:\Users\beb\PycharmProjects\Opossum\docs\model-integration\capability-matrix.md>Capability Matrix</a>) to ground its responses or perform calculations. This relates to future goals like RAG (#<code>docs\about\roadmap.md</code>).</li> <li><strong>Complex Task Decomposition:</strong> Break down complex user requests into manageable sub-problems that the LM can solve sequentially.</li> </ul> <h2 id=key-dspy-modules-for-reasoning>Key DSPy Modules for Reasoning<a class=headerlink href=#key-dspy-modules-for-reasoning title="Permanent link">&para;</a></h2> <ol> <li> <p><strong><code>dspy.ChainOfThought(Signature)</code>:</strong></p> <ul> <li><strong>Concept:</strong> Explicitly prompts the LM to "think step-by-step" to reach the final answer. It adds a <code>rationale</code> field to the signature internally.</li> <li><strong>Use Case:</strong> Useful for arithmetic, symbolic reasoning, or any task where breaking down the problem helps improve accuracy. Opossum could use this for explaining complex biological facts or comparing different aspects of opossum behavior.</li> </ul> </li> <li> <p><strong><code>dspy.ReAct(Signature, tools=[Tool])</code>:</strong></p> <ul> <li><strong>Concept:</strong> Implements the ReAct (Reasoning + Acting) framework. The LM can iteratively use provided <code>tools</code> (which are just Python functions with descriptions) to gather information or perform actions, reasoning about the next step based on tool outputs.</li> <li><strong>Use Case:</strong> Powerful for questions requiring external knowledge lookup (beyond the LM's training data) or calculations. In Opossum, tools could potentially wrap:<ul> <li>A specific database lookup for opossum facts (potentially using data like <code>opossum_dataset_converted.json</code>).</li> <li>A function to check the <a href=c:\Users\beb\PycharmProjects\Opossum\docs\service-availability\context-and-scope.md>Service Availability</a> status.</li> <li>A calculator for simple math mentioned in queries.</li> <li>Even a simplified interface to the <a href=c:\Users\beb\PycharmProjects\Opossum\docs\model-integration\backend-selection.md>Backend Selection</a> logic to explain <em>why</em> a certain model might be chosen.</li> </ul> </li> </ul> </li> <li> <p><strong><code>dspy.MultiChainComparison(Signature, num_comparisons=N)</code>:</strong></p> <ul> <li><strong>Concept:</strong> Generates multiple <code>ChainOfThought</code> responses (<code>N</code> times) and then synthesizes them into a final answer.</li> <li><strong>Use Case:</strong> Improves robustness and explores different reasoning paths for complex questions where a single chain might be insufficient or prone to errors.</li> </ul> </li> </ol> <h2 id=example-chain-of-thought-for-comparison>Example: Chain of Thought for Comparison<a class=headerlink href=#example-chain-of-thought-for-comparison title="Permanent link">&para;</a></h2> <p>Let's imagine using <code>ChainOfThought</code> to handle a comparative query, drawing on general knowledge.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>import</span><span class=w> </span><span class=nn>dspy</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=c1># Assume dspy.settings.configure(lm=...) has been called</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=k>class</span><span class=w> </span><span class=nc>CompareAnimals</span><span class=p>(</span><span class=n>dspy</span><span class=o>.</span><span class=n>Signature</span><span class=p>):</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Compare two animals based on specified criteria.&quot;&quot;&quot;</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>    <span class=n>animal_1</span> <span class=o>=</span> <span class=n>dspy</span><span class=o>.</span><span class=n>InputField</span><span class=p>(</span><span class=n>desc</span><span class=o>=</span><span class=s2>&quot;The first animal.&quot;</span><span class=p>)</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>    <span class=n>animal_2</span> <span class=o>=</span> <span class=n>dspy</span><span class=o>.</span><span class=n>InputField</span><span class=p>(</span><span class=n>desc</span><span class=o>=</span><span class=s2>&quot;The second animal.&quot;</span><span class=p>)</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>    <span class=n>criteria</span> <span class=o>=</span> <span class=n>dspy</span><span class=o>.</span><span class=n>InputField</span><span class=p>(</span><span class=n>desc</span><span class=o>=</span><span class=s2>&quot;Aspects to compare (e.g., diet, habitat, lifespan).&quot;</span><span class=p>)</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>    <span class=n>comparison</span> <span class=o>=</span> <span class=n>dspy</span><span class=o>.</span><span class=n>OutputField</span><span class=p>(</span><span class=n>desc</span><span class=o>=</span><span class=s2>&quot;A detailed comparison addressing the criteria.&quot;</span><span class=p>)</span>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=c1># Use ChainOfThought with the signature</span>
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=n>compare_step_by_step</span> <span class=o>=</span> <span class=n>dspy</span><span class=o>.</span><span class=n>ChainOfThought</span><span class=p>(</span><span class=n>CompareAnimals</span><span class=p>)</span>
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=c1># Run the module</span>
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=n>animal1</span> <span class=o>=</span> <span class=s2>&quot;Opossum&quot;</span>
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=n>animal2</span> <span class=o>=</span> <span class=s2>&quot;Raccoon&quot;</span>
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=n>comparison_criteria</span> <span class=o>=</span> <span class=s2>&quot;diet and typical lifespan&quot;</span>
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=n>result</span> <span class=o>=</span> <span class=n>compare_step_by_step</span><span class=p>(</span><span class=n>animal_1</span><span class=o>=</span><span class=n>animal1</span><span class=p>,</span> <span class=n>animal_2</span><span class=o>=</span><span class=n>animal2</span><span class=p>,</span> <span class=n>criteria</span><span class=o>=</span><span class=n>comparison_criteria</span><span class=p>)</span>
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>
<a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Comparing </span><span class=si>{</span><span class=n>animal1</span><span class=si>}</span><span class=s2> and </span><span class=si>{</span><span class=n>animal2</span><span class=si>}</span><span class=s2> based on </span><span class=si>{</span><span class=n>comparison_criteria</span><span class=si>}</span><span class=s2>:</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=c1># The rationale is generated internally by ChainOfThought but not typically part of the final output field</span>
<a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=c1># To see it, you might inspect the prompt history: dspy.settings.lm.inspect_history(n=1) </span>
<a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Comparison Result:</span><span class=se>\n</span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>comparison</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span> 
</code></pre></div> <h2 id=example-react-for-tool-use>Example: ReAct for Tool Use<a class=headerlink href=#example-react-for-tool-use title="Permanent link">&para;</a></h2> <p>Imagine we want the LM to answer questions using specific facts that might be stored in our <code>opossum_dataset_converted.json</code> or a similar knowledge source. We can create a <em>hypothetical</em> DSPy <code>Tool</code> that allows the <code>ReAct</code> agent to query this data.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kn>import</span><span class=w> </span><span class=nn>dspy</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=c1># --- Hypothetical Tool Definition ---</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=k>class</span><span class=w> </span><span class=nc>OpossumFactTool</span><span class=p>(</span><span class=n>dspy</span><span class=o>.</span><span class=n>Tool</span><span class=p>):</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>    <span class=n>name</span> <span class=o>=</span> <span class=s2>&quot;opossum_fact_lookup&quot;</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>    <span class=n>input_variable</span> <span class=o>=</span> <span class=s2>&quot;query&quot;</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>    <span class=n>output_variable</span> <span class=o>=</span> <span class=s2>&quot;fact&quot;</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>    <span class=n>description</span> <span class=o>=</span> <span class=s2>&quot;Looks up specific facts about opossums (e.g., &#39;gestation period&#39;, &#39;number of teeth&#39;) from the Opossum knowledge base.&quot;</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>    <span class=k>def</span><span class=w> </span><span class=fm>__call__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>query</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>        <span class=n>query</span> <span class=o>=</span> <span class=n>query</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>        <span class=c1># Example lookup logic (replace with actual JSON parsing/search)</span>
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>        <span class=k>if</span> <span class=s2>&quot;gestation period&quot;</span> <span class=ow>in</span> <span class=n>query</span><span class=p>:</span>
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>            <span class=c1># Hypothetical lookup result</span>
<a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>            <span class=k>return</span> <span class=s2>&quot;The gestation period for the Virginia opossum is very short, typically 12-13 days.&quot;</span> 
<a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>        <span class=k>elif</span> <span class=s2>&quot;number of teeth&quot;</span> <span class=ow>in</span> <span class=n>query</span><span class=p>:</span>
<a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>             <span class=c1># Hypothetical lookup result</span>
<a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>            <span class=k>return</span> <span class=s2>&quot;Opossums have 50 teeth, more than any other North American mammal.&quot;</span>
<a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a>            <span class=c1># Fallback if fact not found in our data</span>
<a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a>            <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;Fact not found in Opossum knowledge base for &#39;</span><span class=si>{</span><span class=n>query</span><span class=si>}</span><span class=s2>&#39;.&quot;</span> 
<a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a>
<a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=c1># --- Signature for ReAct ---</span>
<a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a><span class=k>class</span><span class=w> </span><span class=nc>QuestionWithFacts</span><span class=p>(</span><span class=n>dspy</span><span class=o>.</span><span class=n>Signature</span><span class=p>):</span>
<a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Answer questions, potentially using external tools to find specific facts.&quot;&quot;&quot;</span>
<a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a>    <span class=n>question</span> <span class=o>=</span> <span class=n>dspy</span><span class=o>.</span><span class=n>InputField</span><span class=p>()</span>
<a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a>    <span class=n>answer</span> <span class=o>=</span> <span class=n>dspy</span><span class=o>.</span><span class=n>OutputField</span><span class=p>(</span><span class=n>desc</span><span class=o>=</span><span class=s2>&quot;A comprehensive answer incorporating retrieved facts if necessary.&quot;</span><span class=p>)</span>
<a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a>
<a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a><span class=c1># --- Instantiate ReAct Module ---</span>
<a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a><span class=c1># Provide the tool instance to the ReAct module</span>
<a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a><span class=n>agent</span> <span class=o>=</span> <span class=n>dspy</span><span class=o>.</span><span class=n>ReAct</span><span class=p>(</span><span class=n>QuestionWithFacts</span><span class=p>,</span> <span class=n>tools</span><span class=o>=</span><span class=p>[</span><span class=n>OpossumFactTool</span><span class=p>()])</span>
<a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a>
<a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a><span class=c1># --- Run the Agent ---</span>
<a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a><span class=n>user_question</span> <span class=o>=</span> <span class=s2>&quot;How many teeth does an opossum have, and how long is its gestation period?&quot;</span>
<a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a><span class=n>result</span> <span class=o>=</span> <span class=n>agent</span><span class=p>(</span><span class=n>question</span><span class=o>=</span><span class=n>user_question</span><span class=p>)</span>
<a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a>
<a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Question: </span><span class=si>{</span><span class=n>user_question</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Answer: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>answer</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a>
<a id=__codelineno-1-41 name=__codelineno-1-41 href=#__codelineno-1-41></a><span class=c1># Inspect history to see the Thought/Action/Observation steps</span>
<a id=__codelineno-1-42 name=__codelineno-1-42 href=#__codelineno-1-42></a><span class=c1># dspy.settings.lm.inspect_history(n=1) </span>
</code></pre></div> <h2 id=combining-and-optimizing-reasoning-modules>Combining and Optimizing Reasoning Modules<a class=headerlink href=#combining-and-optimizing-reasoning-modules title="Permanent link">&para;</a></h2> <ul> <li><strong>Pipelines:</strong> You can chain these advanced modules together just like simpler ones (see <a href=../building-pipelines/ >Building Pipelines</a>). For example, the output of a <code>ChainOfThought</code> module could feed into a <code>Predict</code> module for summarization.</li> <li><strong>Optimization:</strong> Teleprompters like <code>BootstrapFewShot</code> can optimize reasoning modules too. The training data would need to include examples demonstrating the desired reasoning process (potentially including intermediate steps or tool usage if optimizing <code>ReAct</code>). Metrics would evaluate the final output's correctness and potentially the quality of the reasoning steps.</li> </ul> <h2 id=integration-in-opossum-search>Integration in Opossum Search<a class=headerlink href=#integration-in-opossum-search title="Permanent link">&para;</a></h2> <ul> <li><strong>Complex Query Handling:</strong> Use <code>ChainOfThought</code> or <code>ReAct</code> when the <a href=c:\Users\beb\PycharmProjects\Opossum\docs\model-integration\architecture.md>Request Analyzer</a> detects complex reasoning or comparative queries (#<code>docs\model-integration\backend-selection.md</code>).</li> <li><strong>Fact Grounding:</strong> Implement tools for <code>ReAct</code> that access Opossum's curated knowledge (like <code>opossum_dataset_converted.json</code>) or even external APIs, ensuring responses are grounded in reliable data.</li> <li><strong>Explanation Generation:</strong> Use <code>ChainOfThought</code> to generate explanations for <em>why</em> Opossum provided a certain answer or took a specific action (e.g., explaining fallback logic, #<code>docs\technical\resilience-patterns.md</code>).</li> <li><strong>Structured Data Extraction:</strong> While not strictly reasoning, DSPy modules can be prompted to extract structured information (e.g., parameters for <a href=c:\Users\beb\PycharmProjects\Opossum\docs\image-processing\svg-generation.md>SVG Generation</a>) as part of a reasoning process.</li> </ul> <h2 id=conclusion>Conclusion<a class=headerlink href=#conclusion title="Permanent link">&para;</a></h2> <p>DSPy's advanced reasoning modules like <code>ChainOfThought</code> and <code>ReAct</code> provide powerful ways to build more sophisticated and capable LM applications. By incorporating these techniques, Opossum Search can move beyond simple Q&amp;A to handle more complex user needs, provide deeper insights, and potentially leverage its internal knowledge and tools more effectively. Remember that these modules can also be optimized using DSPy's teleprompters, ensuring both capability and efficiency.</p> </div> </div><footer> <div class=rst-footer-buttons role=navigation aria-label="Footer Navigation"> <a href=../building-pipelines/ class="btn btn-neutral float-left" title="Building Pipelines"><span class="icon icon-circle-arrow-left"></span> Previous</a> <a href=../../../about/history/ class="btn btn-neutral float-right" title="Project History">Next <span class="icon icon-circle-arrow-right"></span></a> </div> <hr> <div role=contentinfo> <!-- Copyright etc --> </div> Built with <a href=https://www.mkdocs.org/ >MkDocs</a> using a <a href=https://github.com/readthedocs/sphinx_rtd_theme>theme</a> provided by <a href=https://readthedocs.org>Read the Docs</a>. </footer> </div> </div> </section> </div> <div class=rst-versions role=note aria-label=Versions> <span class=rst-current-version data-toggle=rst-current-version> <span><a href=../building-pipelines/ style="color: #fcfcfc">&laquo; Previous</a></span> <span><a href=../../../about/history/ style="color: #fcfcfc">Next &raquo;</a></span> </span> </div> <script src=../../../js/jquery-3.6.0.min.js></script> <script>var base_url = "../../..";</script> <script src=../../../js/theme_extra.js></script> <script src=../../../js/theme.js></script> <script src=../../../search/main.js></script> <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script> </body> </html> 