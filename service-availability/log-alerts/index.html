<!DOCTYPE html><html class=writer-html5 lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content=bebo><link rel="shortcut icon" href=../../img/favicon.ico><title>Logging and Alerts - Opossum Search Documentation</title><link rel=stylesheet href=../../css/theme.css><link rel=stylesheet href=../../css/theme_extra.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css><script>
        // Current page data
        var mkdocs_page_name = "Logging and Alerts";
        var mkdocs_page_input_path = "service-availability\\log-alerts.md";
        var mkdocs_page_url = null;
      </script><!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]--><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js></script><script>hljs.highlightAll();</script></head> <body class=wy-body-for-nav role=document> <div class=wy-grid-for-nav> <nav data-toggle=wy-nav-shift class="wy-nav-side stickynav"> <div class=wy-side-scroll> <div class=wy-side-nav-search> <a href=../.. class="icon icon-home"> Opossum Search Documentation </a><div role=search> <form id=rtd-search-form class=wy-form action=../../search.html method=get> <input type=text name=q placeholder="Search docs" aria-label="Search docs" title="Type search term here"> </form> </div> </div> <div class="wy-menu wy-menu-vertical" data-spy=affix role=navigation aria-label="Navigation menu"> <ul> <li class=toctree-l1><a class="reference internal" href=../..>Home</a> </li> </ul> <p class=caption><span class=caption-text>Service Availability</span></p> <ul class=current> <li class=toctree-l1><a href=../context-and-scope/ class="reference internal">Context and Scope</a> </li> <li class=toctree-l1><a href=../quality-requirements/ class="reference internal">Quality Requirements</a> </li> <li class=toctree-l1><a href=../architecture-constraints/ class="reference internal">Architecture Constraints</a> </li> <li class=toctree-l1><a href=../availability-monitoring/ class="reference internal">Availability Monitoring</a> </li> <li class=toctree-l1><a href=../service-outage/ class="reference internal">Error Handling</a> </li> <li class=toctree-l1><a href=../rate-limiting-throttling/ class="reference internal">Rate Limiting</a> </li> <li class="toctree-l1 current"><a class="reference internal current" href=#>Logging and Alerts</a> <ul class=current> <li class=toctree-l2><a class="reference internal" href=#71-logging-strategy>7.1 Logging Strategy</a> </li> <li class=toctree-l2><a class="reference internal" href=#72-log-levels>7.2 Log Levels</a> </li> <li class=toctree-l2><a class="reference internal" href=#73-logging-implementation>7.3 Logging Implementation</a> </li> <li class=toctree-l2><a class="reference internal" href=#74-alert-triggers>7.4 Alert Triggers</a> </li> <li class=toctree-l2><a class="reference internal" href=#75-notification-channels>7.5 Notification Channels</a> </li> <li class=toctree-l2><a class="reference internal" href=#76-alert-templates>7.6 Alert Templates</a> </li> <li class=toctree-l2><a class="reference internal" href=#77-log-analysis>7.7 Log Analysis</a> </li> </ul> </li> <li class=toctree-l1><a href=../fallback-mechanisms/ class="reference internal">Fallback Mechanisms</a> </li> <li class=toctree-l1><a href=../testing-validation/ class="reference internal">Testing and Validation</a> </li> <li class=toctree-l1><a href=../processing-diagrams/ class="reference internal">Diagrams</a> </li> </ul> </div> </div> </nav> <section data-toggle=wy-nav-shift class=wy-nav-content-wrap> <nav class=wy-nav-top role=navigation aria-label="Mobile navigation menu"> <i data-toggle=wy-nav-top class="fa fa-bars"></i> <a href=../..>Opossum Search Documentation</a> </nav> <div class=wy-nav-content> <div class=rst-content><div role=navigation aria-label="breadcrumbs navigation"> <ul class=wy-breadcrumbs> <li><a href=../.. class="icon icon-home" aria-label=Docs></a></li> <li class=breadcrumb-item>Service Availability</li> <li class="breadcrumb-item active">Logging and Alerts</li> <li class=wy-breadcrumbs-aside> </li> </ul> <hr> </div> <div role=main class=document itemscope=itemscope itemtype=http://schema.org/Article> <div class=section itemprop=articleBody> <h1 id=7-logging-and-alerts>7. Logging and Alerts</h1> <h2 id=71-logging-strategy>7.1 Logging Strategy</h2> <table> <thead> <tr> <th>Log Category</th> <th>Purpose</th> <th>Implementation</th> <th>Retention</th> </tr> </thead> <tbody> <tr> <td>Service Status</td> <td>Track service availability changes</td> <td>Structured JSON logs</td> <td>30 days</td> </tr> <tr> <td>Rate Limit</td> <td>Monitor API usage against quotas</td> <td>Counter logs with timestamps</td> <td>90 days</td> </tr> <tr> <td>Error Events</td> <td>Record service failures and exceptions</td> <td>Exception details with stack traces</td> <td>14 days</td> </tr> <tr> <td>Recovery Actions</td> <td>Document automatic recovery attempts</td> <td>Action logs with outcomes</td> <td>14 days</td> </tr> <tr> <td>Performance Metrics</td> <td>Track response times and latency</td> <td>Time-series metrics</td> <td>180 days</td> </tr> </tbody> </table> <h2 id=72-log-levels>7.2 Log Levels</h2> <table> <thead> <tr> <th>Level</th> <th>Usage</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td>DEBUG</td> <td>Detailed diagnostic information</td> <td>"Checking Gemini API availability"</td> </tr> <tr> <td>INFO</td> <td>Normal operational events</td> <td>"Service status changed: Gemini API now AVAILABLE"</td> </tr> <tr> <td>WARNING</td> <td>Non-critical issues</td> <td>"Approaching rate limit (85% used)"</td> </tr> <tr> <td>ERROR</td> <td>Runtime errors, failed operations</td> <td>"Connection to Ollama failed: Connection refused"</td> </tr> <tr> <td>CRITICAL</td> <td>System-wide failures</td> <td>"All services unavailable, switching to offline mode"</td> </tr> </tbody> </table> <h2 id=73-logging-implementation>7.3 Logging Implementation</h2> <pre class=highlight><code class=language-python>import logging
import json
from datetime import datetime

# Configure logger
logger = logging.getLogger("service_availability")
logger.setLevel(logging.INFO)

# File handler
file_handler = logging.FileHandler("service_availability.log")
file_handler.setFormatter(logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s'))
logger.addHandler(file_handler)


class ServiceLogger:
    @staticmethod
    def log_status_change(service_name, old_status, new_status, reason=None):
        """Log a service status change with structured data"""
        log_data = {
            "event_type": "status_change",
            "timestamp": datetime.now().isoformat(),
            "service": service_name,
            "old_status": old_status,
            "new_status": new_status,
            "reason": reason
        }
        logger.info(f"Service status changed: {service_name} now {new_status}", extra={"data": json.dumps(log_data)})

        # Critical service unavailability triggers higher level log
        if new_status == "UNAVAILABLE" and service_name in ["Gemini API", "Ollama"]:
            logger.warning(f"Critical service {service_name} is now unavailable. Reason: {reason}")

    @staticmethod
    def log_rate_limit(service_name, limit_type, current_usage, total_limit):
        """Log rate limit information"""
        usage_percent = (current_usage / total_limit) * 100
        log_level = logging.INFO

        if usage_percent &gt; 95:
            log_level = logging.ERROR
        elif usage_percent &gt; 80:
            log_level = logging.WARNING

        log_data = {
            "event_type": "rate_limit",
            "service": service_name,
            "limit_type": limit_type,
            "usage": current_usage,
            "limit": total_limit,
            "percent": usage_percent
        }

        logger.log(log_level,
                   f"{service_name} {limit_type} usage: {usage_percent:.1f}% ({current_usage}/{total_limit})",
                   extra={"data": json.dumps(log_data)})</code></pre> <h2 id=74-alert-triggers>7.4 Alert Triggers</h2> <table> <thead> <tr> <th>Trigger</th> <th>Condition</th> <th>Severity</th> <th>Response Time</th> </tr> </thead> <tbody> <tr> <td>Service Unavailable</td> <td>Any primary service becomes unavailable</td> <td>High</td> <td>Immediate</td> </tr> <tr> <td>Rate Limit Threshold</td> <td>&gt;95% of minute or daily quota consumed</td> <td>Medium</td> <td>&lt; 5 minutes</td> </tr> <tr> <td>Recovery Failure</td> <td>3+ consecutive failed recovery attempts</td> <td>High</td> <td>Immediate</td> </tr> <tr> <td>Multiple Failovers</td> <td>&gt;5 failovers in 24 hours</td> <td>Medium</td> <td>&lt; 1 hour</td> </tr> <tr> <td>All Services Down</td> <td>No available AI services</td> <td>Critical</td> <td>Immediate</td> </tr> </tbody> </table> <h2 id=75-notification-channels>7.5 Notification Channels</h2> <table> <thead> <tr> <th>Channel</th> <th>Target Audience</th> <th>Alert Types</th> <th>Implementation</th> </tr> </thead> <tbody> <tr> <td>Application Logs</td> <td>Developers</td> <td>All events</td> <td>Structured logging with context</td> </tr> <tr> <td>Email Alerts</td> <td>Operations Team</td> <td>High &amp; Critical events</td> <td>SMTP integration</td> </tr> <tr> <td>UI Notifications</td> <td>End Users</td> <td>Service degradation</td> <td>Browser notifications via frontend</td> </tr> <tr> <td>Status Dashboard</td> <td>All stakeholders</td> <td>Service status, outages</td> <td>Real-time web dashboard</td> </tr> <tr> <td>Slack Channel</td> <td>Operations &amp; Development</td> <td>Medium+ severity</td> <td>Webhook integration</td> </tr> </tbody> </table> <h2 id=76-alert-templates>7.6 Alert Templates</h2> <table> <thead> <tr> <th>Alert Type</th> <th>Template</th> <th>Channel</th> </tr> </thead> <tbody> <tr> <td>Service Down</td> <td>"[ALERT] {service_name} is DOWN. Reason: {reason}. Failover to {fallback_service} initiated."</td> <td>Email, Slack</td> </tr> <tr> <td>Rate Limit</td> <td>"[WARNING] {service_name} approaching rate limit: {usage_percent}% of {limit_type} used."</td> <td>Logs, Slack</td> </tr> <tr> <td>Recovery Success</td> <td>"[INFO] {service_name} successfully recovered after {downtime} minutes of unavailability."</td> <td>Logs</td> </tr> <tr> <td>Client Notification</td> <td>"Using alternative AI service due to temporary unavailability. Some features may be limited."</td> <td>UI</td> </tr> </tbody> </table> <h2 id=77-log-analysis>7.7 Log Analysis</h2> <table> <thead> <tr> <th>Analysis Type</th> <th>Purpose</th> <th>Tools</th> <th>Frequency</th> </tr> </thead> <tbody> <tr> <td>Availability Reporting</td> <td>Calculate uptime percentages</td> <td>Custom scripts</td> <td>Daily</td> </tr> <tr> <td>Error Pattern Detection</td> <td>Identify recurring issues</td> <td>Log parsing</td> <td>Weekly</td> </tr> <tr> <td>Rate Limit Forecasting</td> <td>Predict quota exhaustion</td> <td>Time-series analysis</td> <td>Hourly</td> </tr> <tr> <td>Service Quality Metrics</td> <td>Track performance degradation</td> <td>Dashboards</td> <td>Real-time</td> </tr> <tr> <td>Audit Trail</td> <td>Security and compliance review</td> <td>Log archiving</td> <td>Monthly</td> </tr> </tbody> </table> </div> </div><footer> <div class=rst-footer-buttons role=navigation aria-label="Footer Navigation"> <a href=../rate-limiting-throttling/ class="btn btn-neutral float-left" title="Rate Limiting"><span class="icon icon-circle-arrow-left"></span> Previous</a> <a href=../fallback-mechanisms/ class="btn btn-neutral float-right" title="Fallback Mechanisms">Next <span class="icon icon-circle-arrow-right"></span></a> </div> <hr> <div role=contentinfo> <!-- Copyright etc --> </div> Built with <a href=https://www.mkdocs.org/ >MkDocs</a> using a <a href=https://github.com/readthedocs/sphinx_rtd_theme>theme</a> provided by <a href=https://readthedocs.org>Read the Docs</a>. </footer> </div> </div> </section> </div> <div class=rst-versions role=note aria-label=Versions> <span class=rst-current-version data-toggle=rst-current-version> <span><a href=../rate-limiting-throttling/ style="color: #fcfcfc">&laquo; Previous</a></span> <span><a href=../fallback-mechanisms/ style="color: #fcfcfc">Next &raquo;</a></span> </span> </div> <script src=../../js/jquery-3.6.0.min.js></script> <script>var base_url = "../..";</script> <script src=../../js/theme_extra.js></script> <script src=../../js/theme.js></script> <script src=../../search/main.js></script> <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script> </body> </html> 